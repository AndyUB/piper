2026-02-18 22:57:22,282	INFO worker.py:2007 -- Started a local Ray instance.
/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(run_dp_rank pid=985582)[0m Namespace(model='debug', schedule='interleaved-1f1b', dp=1, pp=2, batch_size=16, mbs=4, seq_len=256, warmup=5, iters=10, tracing=True, naive_gradient_sync=False)
[36m(run_dp_rank pid=985582)[0m 2026-02-18 22:57:36,845 - piper_coordinator - DEBUG - Running DP rank 1 of 1
[36m(run_dp_rank pid=985582)[0m Schedule:
[36m(run_dp_rank pid=985582)[0m 0:0:f	0:1:f	2:0:f	2:1:f	0:2:f	0:3:f	2:0:b	 -- 	2:1:b	2:2:f	0:0:b	2:3:f	0:1:b	 -- 	2:2:b	2:3:b	0:2:b	0:3:b	0:0:u	
[36m(run_dp_rank pid=985582)[0m  -- 	1:0:f	1:1:f	3:0:f	3:0:b	3:1:f	3:1:b	1:2:f	1:0:b	1:3:f	1:1:b	3:2:f	3:2:b	3:3:f	3:3:b	1:2:b	1:3:b	1:0:u	 -- 	
[36m(run_dp_rank pid=985582)[0m 2026-02-18 22:57:36,868 - piper_compile - DEBUG - mbs: 4, stages: 4, devices: 2
[36m(run_dp_rank pid=985582)[0m 2026-02-18 22:57:36,868 - piper_compile - DEBUG - Fwd/bwd schedule: [[Task(pp_rank=0, stage_id=0, mb_idx=0, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=1, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=0, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=1, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=2, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=3, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=0, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=1, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=2, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=0, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=3, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=1, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=2, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=3, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=2, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=3, is_fwd=False, upd=False)], [Task(pp_rank=1, stage_id=1, mb_idx=0, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=1, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=0, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=0, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=1, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=1, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=2, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=0, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=3, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=1, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=2, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=2, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=3, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=3, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=2, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=3, is_fwd=False, upd=False)]]
[36m(run_dp_rank pid=985582)[0m 2026-02-18 22:57:36,868 - piper_compile - DEBUG - P2P comms: [(0, 1, 0), (0, 1, 1), (1, 2, 0), (2, 3, 0), (1, 2, 1), (2, 3, 1), (0, 1, 2), (3, 2, 0), (0, 1, 3), (2, 1, 0), (3, 2, 1), (2, 1, 1), (1, 2, 2), (2, 3, 2), (1, 0, 0), (1, 2, 3), (2, 3, 3), (1, 0, 1), (3, 2, 2), (2, 1, 2), (3, 2, 3), (2, 1, 3), (1, 0, 2), (1, 0, 3)]
[36m(run_dp_rank pid=985582)[0m 2026-02-18 22:57:36,868 - piper_compile - DEBUG - P2P schedules: {0: [(0, 1, 0, True), (0, 1, 1, True), (1, 2, 0, False), (2, 3, 0, True), (1, 2, 1, False), (2, 3, 1, True), (0, 1, 2, True), (3, 2, 0, False), (0, 1, 3, True), (2, 1, 0, True), (3, 2, 1, False), (2, 1, 1, True), (1, 2, 2, False), (2, 3, 2, True), (1, 0, 0, False), (1, 2, 3, False), (2, 3, 3, True), (1, 0, 1, False), (3, 2, 2, False), (2, 1, 2, True), (3, 2, 3, False), (2, 1, 3, True), (1, 0, 2, False), (1, 0, 3, False)], 1: [(0, 1, 0, False), (0, 1, 1, False), (1, 2, 0, True), (2, 3, 0, False), (1, 2, 1, True), (2, 3, 1, False), (0, 1, 2, False), (3, 2, 0, True), (0, 1, 3, False), (2, 1, 0, False), (3, 2, 1, True), (2, 1, 1, False), (1, 2, 2, True), (2, 3, 2, False), (1, 0, 0, True), (1, 2, 3, True), (2, 3, 3, False), (1, 0, 1, True), (3, 2, 2, True), (2, 1, 2, False), (3, 2, 3, True), (2, 1, 3, False), (1, 0, 2, True), (1, 0, 3, True)]}
[36m(run_dp_rank pid=985582)[0m 2026-02-18 22:57:36,934 - piper_actor - DEBUG - DP rank 0 created actor Actor(PiperActor, 684731f6d9371809297f9d1901000000) global rank 0
[36m(run_dp_rank pid=985582)[0m 2026-02-18 22:57:36,935 - piper_actor - DEBUG - DP rank 0 created actor Actor(PiperActor, 0a439890f9b401c87eee707e01000000) global rank 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:39,966 - piper_actor - INFO - Initializing Ray actor 1 global rank 1 GPU 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:40,132 - piper_actor - INFO - Initializing Ray actor 0 global rank 0 GPU 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:43,104 - piper_actor - DEBUG - Actor 1 has GPU 2, joined the global process group
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:43,105 - piper_actor - INFO - Global rank 1 joined its pp group 0 along with ranks [0, 1]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:43,104 - piper_actor - DEBUG - Actor 0 has GPU 1, joined the global process group
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:43,105 - piper_actor - INFO - Global rank 0 joined its pp group 0 along with ranks [0, 1]
[36m(run_dp_rank pid=985582)[0m 2026-02-18 22:57:43,319 - piper_compile - INFO - DP rank 1 compiling...
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:46,742 - piper_actor - INFO - Loading stage 0 graph on actor 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:46,842 - piper_actor - INFO - Loading stage 1 graph on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:48,067 - piper_actor - INFO - Loading stage 2 graph on actor 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:48,703 - piper_actor - INFO - Loading stage 3 graph on actor 1
[36m(run_dp_rank pid=985582)[0m 2026-02-18 22:57:48,830 - piper_backend - WARNING - Should not directly call compiled module, running non-distributed execution
[36m(run_dp_rank pid=985582)[0m 2026-02-18 22:57:55,300 - piper_compile - INFO - DP rank 1 done.
[36m(run_dp_rank pid=985582)[0m Running 5 warmup iterations...
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:55,343 - piper_actor - DEBUG - Actor 1 loaded labels torch.Size([16, 256, 512])
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:55,349 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:55,349 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m [rank1]:[W218 22:57:55.831571789 ProcessGroupNCCL.cpp:4068] Warning: An unbatched P2P op (send/recv) was called on this ProcessGroup with size 2.  In lazy initialization mode, this will result in a new 2-rank NCCL communicator to be created. (function operator())
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:55,329 - piper_actor - DEBUG - Actor 0 loaded inputs 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:55,349 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:56,101 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:56,101 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m [rank0]:[W218 22:57:56.583910970 ProcessGroupNCCL.cpp:4068] Warning: An unbatched P2P op (send/recv) was called on this ProcessGroup with size 2.  In lazy initialization mode, this will result in a new 2-rank NCCL communicator to be created. (function operator())
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:58,389 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:58,390 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:58,390 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,380 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,381 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,381 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,382 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,391 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,391 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,391 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,391 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,391 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,392 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:58,392 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m [rank0]:[W218 22:57:58.874209274 ProcessGroupNCCL.cpp:4068] Warning: An unbatched P2P op (send/recv) was called on this ProcessGroup with size 2.  In lazy initialization mode, this will result in a new 2-rank NCCL communicator to be created. (function operator())
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,210 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,211 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,212 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,212 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,212 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m [rank1]:[W218 22:57:59.694541566 ProcessGroupNCCL.cpp:4068] Warning: An unbatched P2P op (send/recv) was called on this ProcessGroup with size 2.  In lazy initialization mode, this will result in a new 2-rank NCCL communicator to be created. (function operator())
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,430 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,430 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,430 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,432 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,432 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,441 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,441 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,443 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,443 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,452 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,452 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,453 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,430 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,430 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,430 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,440 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,440 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,441 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,441 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,441 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,442 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,450 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,450 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,450 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,450 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,451 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,451 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,484 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,484 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,484 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,484 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,485 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,485 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,544 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,545 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,545 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,545 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,545 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,545 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,545 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,546 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,546 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,547 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,547 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,549 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,550 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,551 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,523 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,523 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,523 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,565 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,565 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,565 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,566 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,566 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,578 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,578 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,578 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,578 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,601 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,601 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,604 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,604 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,604 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,609 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,609 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,609 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,609 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,609 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,611 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,611 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,611 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,611 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,611 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,611 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,611 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,612 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,612 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,615 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,616 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,616 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,616 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,616 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,617 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,618 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,618 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,618 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,618 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,618 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:57:59,618 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985628)[0m /m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/torch/autograd/graph.py:865: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:330.)
[36m(PiperActor pid=985628)[0m   return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,598 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,598 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,599 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,599 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,599 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,600 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,600 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,600 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,600 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,601 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,601 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,601 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,605 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,606 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,606 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,606 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,607 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,607 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,607 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,607 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,607 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,610 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,610 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,610 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,610 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,610 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,612 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,612 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:57:59,612 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,060 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,061 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,064 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,064 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,065 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,053 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,055 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,055 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,055 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,055 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,056 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,058 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,058 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,059 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,059 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,059 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,060 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,060 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,060 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,065 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,066 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,066 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,066 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,071 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,071 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,071 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,071 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,168 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,169 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,169 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,170 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,170 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,173 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,173 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,174 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,180 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,181 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,185 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,185 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,185 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,185 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,186 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,187 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,187 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,191 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,191 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,191 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,191 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,192 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,192 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,193 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,193 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,193 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,193 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,260 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,260 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,260 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,261 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,261 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,263 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,264 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,264 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,264 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,264 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,265 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,265 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,265 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,268 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,268 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,270 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,270 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,270 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,270 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,270 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,271 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,271 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,271 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,272 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,272 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,170 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,171 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,171 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,176 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,176 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,176 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,176 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,186 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,186 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,186 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,191 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,194 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,194 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,194 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,198 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,199 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,199 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,259 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,263 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,263 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,264 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,264 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,264 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,264 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,266 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,267 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,267 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,267 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,267 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,268 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,268 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,268 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,268 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,268 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,270 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,271 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,271 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,271 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,271 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,272 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,272 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,272 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,272 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,272 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,274 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,274 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,275 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,282 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,282 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,282 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,282 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,282 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,283 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,283 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,283 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,283 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,283 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,283 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,286 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,286 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,287 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,293 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,293 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,293 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,293 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,294 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,297 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,297 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,298 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,298 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,299 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,299 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,301 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,301 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,302 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,306 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,306 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,306 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,306 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,306 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,308 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,308 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,308 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,308 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,308 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,308 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,308 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,309 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,309 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,311 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,311 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,311 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,311 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,311 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,312 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,312 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,313 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,313 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,313 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,274 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,275 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,275 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,275 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,275 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,276 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,278 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,278 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,279 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,279 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,279 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,279 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,282 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,282 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,282 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,288 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,288 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,288 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,288 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,288 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,289 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,289 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,289 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,289 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,290 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,290 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,290 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,294 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,294 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,295 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,295 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,298 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,298 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,298 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,299 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,299 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,301 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,301 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,301 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,301 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,301 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,307 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,307 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,307 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,313 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,313 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,321 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,321 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,323 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,324 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,325 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,331 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,331 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,331 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,332 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,332 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,334 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,334 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,336 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,341 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,342 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,345 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,346 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,346 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,346 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,347 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,347 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,348 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,351 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,352 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,352 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,352 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,317 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,317 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,317 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,318 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,318 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,318 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,320 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,320 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,321 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,321 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,321 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,322 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,322 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,322 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,326 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,327 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,328 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,328 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,332 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,332 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,332 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,332 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,334 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,335 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,335 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,339 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,339 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,339 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,339 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,346 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,347 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,347 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,351 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,353 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,353 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,353 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,353 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,354 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,354 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,366 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,366 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,367 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,367 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,367 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,369 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,369 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,370 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,370 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,370 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,370 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,370 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,370 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,373 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,374 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,376 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,376 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,376 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,376 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,376 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,376 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,376 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,377 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,377 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,377 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,380 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,380 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,381 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,387 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,387 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,387 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,387 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,388 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,388 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,388 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,388 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,388 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,389 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,389 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,391 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,391 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,354 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,354 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,355 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,359 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,360 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,360 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,366 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,369 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,369 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,369 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,370 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,370 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,370 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,372 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,372 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,373 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,373 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,373 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,374 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,374 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,374 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,374 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,374 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,376 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,376 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,377 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,377 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,377 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,378 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,378 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,378 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,378 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,378 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,380 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,380 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,381 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,381 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,381 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,382 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,384 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,384 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,384 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,384 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,384 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,385 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,387 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,387 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,388 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,392 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,392 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,392 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,392 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,393 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,392 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,398 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,399 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,399 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,399 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,399 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,403 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,403 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,403 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,403 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,404 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,404 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,407 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,407 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,407 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,411 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,411 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,411 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,412 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,412 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,413 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,413 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,413 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,413 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,413 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,413 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,413 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,414 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,414 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,416 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,416 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,417 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,417 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,417 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,418 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,418 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,418 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,418 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,418 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,418 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,418 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,422 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,422 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,424 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,424 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,426 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,394 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,394 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,394 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,394 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,394 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,395 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,395 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,399 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,399 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,399 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,399 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,404 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,404 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,404 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,404 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,404 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,406 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,407 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,407 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,407 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,407 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,412 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,412 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,412 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,417 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,418 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,418 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,419 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,419 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,419 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,421 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,421 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,422 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,422 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,422 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,422 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,423 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,423 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,427 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,428 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,428 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,429 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,431 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,432 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,432 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,432 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,433 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,435 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,435 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,436 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,442 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,442 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,446 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,446 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,447 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,447 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,448 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,448 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,448 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,452 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,452 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,453 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,453 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,454 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,454 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,454 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,454 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,454 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,455 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,466 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,466 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,467 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,467 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,467 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,469 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,469 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,469 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,469 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,470 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,470 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,470 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,470 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,433 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,433 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,433 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,433 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,435 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,435 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,436 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,439 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,440 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,440 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,440 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,447 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,447 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,448 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,452 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,455 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,455 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,455 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,459 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,461 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,461 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,466 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,468 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,469 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,469 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,469 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,469 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,470 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,472 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,472 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,472 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,473 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,473 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,473 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,473 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,475 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,475 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,475 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,476 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,476 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,476 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,476 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,476 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,477 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,477 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,479 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,479 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,481 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,486 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,487 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,487 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,487 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,487 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,487 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,487 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,488 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,488 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,488 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,488 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,490 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,491 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,492 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,498 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,498 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,498 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,498 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,499 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,502 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,502 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,503 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,503 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,504 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,504 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,506 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,506 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,507 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,473 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,473 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,474 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,474 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,474 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,476 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,476 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,476 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,476 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,476 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,477 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,477 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,478 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,478 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,478 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,480 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,480 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,480 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,480 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,480 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,481 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,483 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,483 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,484 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,484 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,484 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,485 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,487 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,487 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,487 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,492 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,492 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,492 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,492 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,492 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,493 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,493 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,493 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,494 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,494 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,494 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,494 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,498 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,499 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,499 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,499 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,503 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,503 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,504 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,504 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,504 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,506 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,506 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,506 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,507 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,507 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,511 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,511 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,511 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,511 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,511 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,512 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,513 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,513 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,513 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,513 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,513 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,513 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,514 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,514 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,516 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,516 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,516 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,516 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,516 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,517 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,517 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,518 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,518 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,518 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,518 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,518 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,522 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,522 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,524 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,524 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,526 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,531 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,532 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,532 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,532 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,532 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,535 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,535 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,536 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,542 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,542 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,546 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,547 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,547 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,547 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,548 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,548 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,548 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,512 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,512 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,512 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,517 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,518 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,518 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,518 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,518 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,518 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,521 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,521 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,521 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,521 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,521 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,522 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,522 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,523 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,527 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,528 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,528 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,528 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,532 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,533 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,533 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,533 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,535 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,535 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,535 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,540 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,540 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,540 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,540 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,547 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,548 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,548 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,552 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,552 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,553 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,553 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,554 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,554 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,554 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,554 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,555 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,555 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,566 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,566 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,567 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,567 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,567 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,569 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,569 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,570 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,570 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,570 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,570 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,570 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,570 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,573 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,574 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,576 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,576 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,576 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,576 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,576 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,577 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,577 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,577 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,577 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,577 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,579 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,580 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,581 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,587 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,587 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,587 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,587 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,588 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,588 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,588 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,588 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,588 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,589 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,589 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,552 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,555 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,555 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,555 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,560 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,561 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,561 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,566 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,569 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,569 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,570 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,570 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,570 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,570 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,572 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,573 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,573 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,573 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,573 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,574 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,574 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,574 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,574 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,574 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,576 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,577 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,577 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,577 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,577 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,578 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,578 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,578 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,578 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,578 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,580 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,580 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,581 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,581 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,581 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,582 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,584 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,584 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,584 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,584 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,585 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,585 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,587 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,588 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,588 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,591 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,591 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,592 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,598 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,599 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,599 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,599 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,599 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,603 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,603 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,604 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,604 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,604 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,605 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,607 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,607 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,608 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,612 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,612 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,612 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,612 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,612 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,613 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,613 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,613 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,614 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,614 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,614 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,614 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,614 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,614 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,617 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,617 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,617 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,617 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,617 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,618 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,618 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,618 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,618 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,618 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,619 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,619 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,622 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,623 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,625 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,625 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,626 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,592 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,593 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,593 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,593 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,593 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,594 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,594 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,594 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,594 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,595 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,595 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,595 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,599 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,599 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,600 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,600 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,604 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,604 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,604 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,605 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,605 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,607 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,607 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,607 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,608 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,608 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,613 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,613 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,613 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,618 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,619 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,619 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,619 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,619 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,619 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,622 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,622 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,622 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,622 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,622 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,623 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,623 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,623 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,628 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,629 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,629 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,629 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(run_dp_rank pid=985582)[0m Running 10 timed iterations...
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,632 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,632 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,633 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,633 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,633 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,635 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,636 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,637 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,643 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,643 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,647 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,647 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,648 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,648 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,649 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,649 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,649 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,653 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,653 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,653 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,654 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,655 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,655 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,655 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,655 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,655 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,655 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,667 - piper_actor - INFO - Actor 1: Tracing enabled
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,669 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,669 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,633 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,633 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,634 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,634 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,636 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,636 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,636 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,640 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,640 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,641 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,641 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,648 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,648 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,649 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,653 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,656 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,656 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,656 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,660 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,662 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,662 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,666 - piper_actor - INFO - Actor 0: Tracing enabled
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,669 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,673 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,673 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,673 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,675 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,675 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,676 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,676 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,676 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,676 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,677 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,677 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,677 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,677 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,679 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,679 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,680 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,680 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,680 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,680 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,680 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,681 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,681 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,681 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,683 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,683 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,685 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,691 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,691 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,691 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,691 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,691 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,692 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,692 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,692 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,692 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,692 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,692 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,695 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,695 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,696 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,702 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,702 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,703 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,703 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,703 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,707 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,707 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,707 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,708 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,672 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,672 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,673 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,673 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,673 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,673 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,675 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,676 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,676 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,676 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,676 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,677 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,677 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,677 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,677 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,677 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,679 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,680 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,680 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,680 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,680 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,681 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,681 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,681 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,681 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,681 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,683 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,683 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,684 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,684 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,684 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,685 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,687 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,687 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,688 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,688 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,688 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,688 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,690 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,691 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,692 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,696 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,696 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,697 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,697 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,697 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,698 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,698 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,698 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,698 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,698 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,699 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,707 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,708 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,708 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,710 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,711 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,712 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,716 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,716 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,716 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,716 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,716 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,718 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,718 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,719 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,719 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,719 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,720 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,720 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,720 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,720 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,722 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,723 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,723 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,723 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,723 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,724 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,724 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,729 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,729 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,730 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,730 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,730 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,731 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,731 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,735 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,736 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,736 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,742 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,743 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,743 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,744 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,744 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,747 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,748 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,748 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,712 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,712 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,712 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,712 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,713 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,713 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,716 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,716 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,716 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,719 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,719 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,719 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,719 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,719 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,720 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,720 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,721 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,725 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,726 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,726 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,726 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,726 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,727 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,729 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,729 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,729 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,729 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,729 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,730 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,730 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,730 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,735 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,736 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,736 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,743 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,747 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,747 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,747 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,748 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,748 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,749 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,754 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,755 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,759 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,759 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,759 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,759 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,760 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,760 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,764 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,767 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,768 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,768 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,768 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,769 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,769 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,770 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,770 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,770 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,770 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,785 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,785 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,759 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,763 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,763 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,764 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,764 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,765 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,765 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,768 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,772 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,774 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,774 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,774 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,778 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,779 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,779 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,785 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,787 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,787 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,788 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,788 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,788 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,788 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,788 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,790 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,791 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,792 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,792 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,792 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,792 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,792 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,793 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,793 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,793 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,795 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,795 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,796 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,796 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,796 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,796 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,796 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,796 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,797 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,797 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,799 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,799 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,801 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,806 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,807 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,807 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,807 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,807 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,807 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,807 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,808 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,808 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,808 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,808 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,811 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,812 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,812 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,818 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,819 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,819 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,819 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,819 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,823 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,823 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,823 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,823 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,825 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,825 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,788 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,789 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,791 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,791 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,792 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,792 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,792 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,793 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,793 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,793 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,793 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,793 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,795 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,795 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,796 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,796 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,796 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,797 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,797 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,797 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,797 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,797 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,799 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,799 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,800 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,800 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,800 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,801 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,803 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,803 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,803 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,804 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,804 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,804 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,806 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,806 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,808 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,812 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,812 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,813 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,813 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,813 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,813 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,813 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,814 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,814 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,814 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,814 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,823 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,828 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,828 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,828 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,832 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,832 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,833 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,833 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,833 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,834 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,834 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,836 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,836 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,836 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,836 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,836 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,837 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,837 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,840 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,840 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,841 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,841 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,841 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,841 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,841 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,846 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,846 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,846 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,846 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,847 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,847 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,847 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,850 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,851 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,851 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,857 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,858 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,858 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,858 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,858 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,861 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,861 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,862 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,827 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,828 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,828 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,828 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,829 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,829 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,833 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,833 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,833 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,835 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,836 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,836 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,836 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,836 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,837 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,837 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,837 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,841 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,843 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,843 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,843 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,843 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,843 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,845 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,845 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,846 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,846 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,846 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,847 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,847 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,847 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,851 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,853 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,853 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,858 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,862 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,862 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,862 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,862 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,863 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,863 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,868 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,868 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,872 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,872 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,872 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,872 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,874 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,874 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,878 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,882 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,882 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,882 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,882 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,883 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,883 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,884 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,884 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,884 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,884 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,900 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,900 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,903 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,903 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,903 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,905 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,905 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,872 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,877 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,877 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,878 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,878 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,878 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,879 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,882 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,886 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,888 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,888 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,888 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,892 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,893 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,894 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,899 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,902 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,902 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,903 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,903 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,903 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,904 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,906 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,906 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,907 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,908 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,908 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,910 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,910 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,910 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,910 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,911 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,911 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,911 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,911 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,911 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,911 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,913 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,914 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,915 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,921 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,921 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,921 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,921 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,922 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,922 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,922 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,922 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,922 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,922 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,923 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,925 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,925 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,926 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,932 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,932 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,932 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,932 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,933 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,936 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,936 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,937 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,937 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,938 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,938 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,940 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,940 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,941 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,908 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,908 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,908 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,910 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,910 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,910 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,910 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,911 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,911 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,911 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,912 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,912 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,912 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,914 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,914 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,914 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,914 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,915 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,915 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,917 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,918 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,918 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,918 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,918 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,919 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,921 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,921 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,922 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,926 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,926 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,927 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,927 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,927 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,928 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,928 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,928 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,928 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,928 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,929 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,937 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,941 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,941 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,941 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,941 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,942 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,942 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,945 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,946 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,946 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,945 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,945 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,945 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,946 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,946 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,947 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,947 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,948 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,949 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,949 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,949 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,949 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,949 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,950 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,952 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,952 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,952 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,952 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,952 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,953 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,953 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,959 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,959 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,959 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,959 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,959 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,960 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,960 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,962 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,962 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,963 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,969 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,969 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,969 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,970 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,970 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,972 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,972 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,974 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,979 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,980 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,984 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,984 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,948 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,948 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,948 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,949 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,949 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,949 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,949 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,950 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,954 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,955 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,955 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,956 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,956 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,956 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,958 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,958 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,959 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,959 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,959 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,959 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,960 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,960 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,964 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,965 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,966 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,969 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,974 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,974 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,974 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,974 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,975 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,975 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,984 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,984 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,984 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,985 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,985 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,989 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,992 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,992 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,993 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,993 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,994 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,994 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,995 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,995 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,995 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:00,995 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,010 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,010 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,013 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,014 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,014 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,016 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,016 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,017 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,017 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,017 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,017 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,018 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,018 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,018 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,018 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,020 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,020 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,021 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,021 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,021 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,021 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,022 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,022 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,022 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,022 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,988 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,988 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,989 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,989 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,990 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,990 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,993 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,997 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,998 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,998 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:00,999 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,003 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,004 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,004 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,010 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,013 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,013 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,013 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,014 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,014 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,014 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,016 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,016 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,017 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,017 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,017 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,018 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,018 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,018 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,018 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,018 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,020 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,021 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,021 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,021 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,021 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,022 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,022 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,022 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,022 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,022 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,024 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,024 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,024 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,024 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,026 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,031 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,032 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,032 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,032 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,032 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,032 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,032 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,033 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,033 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,033 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,033 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,035 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,036 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,037 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,043 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,043 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,043 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,043 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,043 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,047 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,047 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,047 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,047 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,049 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,049 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,051 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,051 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,052 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,056 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,056 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,056 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,056 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,056 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,057 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,058 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,059 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,059 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,059 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,059 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,059 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,060 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,060 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,062 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,062 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,062 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,063 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,063 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,064 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,064 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,025 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,025 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,025 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,026 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,028 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,028 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,029 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,029 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,029 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,029 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,031 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,032 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,033 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,037 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,037 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,037 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,038 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,038 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,038 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,038 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,039 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,039 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,039 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,039 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,047 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,051 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,052 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,052 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,052 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,053 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,053 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,056 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,056 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,056 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,058 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,059 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,059 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,059 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,059 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,060 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,060 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,060 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,065 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,066 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,066 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,069 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,069 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,069 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,069 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,070 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,070 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,070 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,072 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,072 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,074 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,080 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,080 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,080 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,081 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,081 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,083 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,083 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,084 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,090 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,090 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,094 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,094 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,095 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,095 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,096 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,096 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,099 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,103 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,103 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,066 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,066 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,066 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,068 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,069 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,069 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,069 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,069 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,070 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,070 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,070 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,075 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,076 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,076 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,080 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,084 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,084 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,085 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,085 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,086 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,086 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,095 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,099 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,099 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,099 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,100 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,100 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,101 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,104 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,104 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,104 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,105 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,105 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,105 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,105 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,106 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,106 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,121 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,121 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,124 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,124 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,124 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,126 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,127 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,129 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,129 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,131 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,131 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,133 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,133 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,135 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,135 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,136 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,142 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,142 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,143 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,143 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,143 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,143 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,143 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,108 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,109 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,109 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,110 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,114 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,115 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,115 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,120 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,123 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,123 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,124 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,124 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,124 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,125 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,127 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,127 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,128 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,129 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,129 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,129 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,131 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,131 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,132 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,133 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,133 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,133 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,135 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,135 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,135 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,136 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,136 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,136 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,138 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,139 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,139 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,139 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,139 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,140 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,142 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,142 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,143 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,143 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,143 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,144 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,144 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,146 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,146 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,148 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,153 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,154 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,154 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,154 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,154 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,158 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,158 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,158 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,158 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,159 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,160 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,161 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,162 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,163 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,166 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,166 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,167 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,167 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,167 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,168 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,168 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,170 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,170 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,170 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,170 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,170 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,171 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,171 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,173 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,173 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,173 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,173 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,173 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,174 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,174 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,180 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,180 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,180 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,180 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,180 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,181 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,181 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,183 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,183 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,185 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,148 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,148 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,148 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,148 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,148 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,149 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,149 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,149 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,149 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,150 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,150 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,158 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,162 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,162 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,163 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,163 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,164 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,164 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,167 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,167 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,167 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,169 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,169 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,170 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,170 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,170 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,171 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,171 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,171 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,175 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,176 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,177 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,177 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,177 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,177 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,179 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,179 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,180 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,180 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,180 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,181 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,181 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,181 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,185 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,187 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,187 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,190 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,191 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,191 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,191 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,191 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,193 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,194 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,195 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,201 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,201 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,205 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,205 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,205 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,205 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,207 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,207 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,210 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,213 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,213 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,214 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,214 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,215 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,215 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,215 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,215 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,216 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,216 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,191 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,195 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,195 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,195 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,195 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,196 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,196 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,205 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,209 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,209 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,209 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,210 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,211 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,211 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,214 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,218 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,219 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,219 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,220 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,224 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,225 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,225 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,230 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,231 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,234 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,234 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,234 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,236 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,236 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,237 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,237 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,237 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,238 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,238 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,238 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,238 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,238 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,240 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,241 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,241 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,241 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,241 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,242 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,242 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,242 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,242 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,242 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,244 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,245 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,246 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,252 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,252 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,252 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,252 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,253 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,253 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,253 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,253 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,253 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,254 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,254 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,256 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,256 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,257 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,263 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,263 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,264 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,264 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,264 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,230 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,233 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,233 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,234 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,234 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,234 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,234 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,237 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,237 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,237 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,237 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,237 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,238 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,238 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,238 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,238 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,239 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,241 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,241 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,241 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,241 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,241 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,242 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,242 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,242 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,242 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,242 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,245 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,245 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,245 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,245 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,245 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,246 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,248 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,248 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,249 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,249 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,249 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,250 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,252 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,252 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,253 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,257 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,257 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,258 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,258 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,258 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,259 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,259 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,259 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,259 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,260 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,260 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,267 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,267 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,268 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,268 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,269 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,269 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,271 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,272 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,272 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,276 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,276 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,277 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,277 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,277 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,278 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,278 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,280 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,280 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,280 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,280 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,280 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,281 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,281 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,283 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,283 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,283 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,283 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,284 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,284 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,285 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,290 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,290 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,290 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,290 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,290 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,291 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,291 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,293 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,293 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,294 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,300 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,300 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,301 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,301 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,301 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,268 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,272 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,272 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,272 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,273 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,273 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,273 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,277 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,277 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,277 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,279 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,279 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,280 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,280 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,280 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,281 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,281 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,281 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,285 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,286 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,287 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,287 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,287 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,287 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,289 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,289 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,290 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,290 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,290 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,290 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,291 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,291 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,295 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,296 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,297 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,300 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,303 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,303 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,305 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,310 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,311 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,315 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,315 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,315 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,315 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,316 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,317 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,320 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,324 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,324 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,324 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,324 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,325 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,326 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,326 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,326 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,326 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,326 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,341 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,341 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,304 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,305 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,305 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,305 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,306 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,306 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,315 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,319 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,320 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,320 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,320 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,321 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,321 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,324 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,328 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,330 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,330 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,330 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,334 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,335 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,335 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,341 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,344 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,344 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,345 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,345 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,345 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,347 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,347 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,348 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,348 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,348 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,349 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,349 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,349 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,349 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,349 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,351 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,351 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,352 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,352 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,352 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,353 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,353 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,353 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,353 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,353 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,355 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,355 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,357 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,362 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,363 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,363 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,363 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,365 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,365 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,365 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,365 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,366 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,366 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,366 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,368 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,368 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,370 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,375 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,376 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,376 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,376 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,376 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,380 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,380 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,380 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,380 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,382 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,382 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,345 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,345 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,345 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,345 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,347 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,348 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,348 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,348 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,348 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,349 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,349 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,349 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,349 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,349 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,351 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,352 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,352 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,352 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,352 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,353 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,353 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,355 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,356 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,356 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,359 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,359 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,360 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,360 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,360 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,362 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,364 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,365 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,365 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,365 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,365 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,366 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,368 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,368 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,369 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,373 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,373 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,374 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,374 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,374 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,375 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,375 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,375 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,375 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,376 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,376 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,380 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,384 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,384 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,385 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,389 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,389 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,389 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,389 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,389 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,390 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,390 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,392 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,392 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,392 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,393 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,393 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,393 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,393 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,395 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,395 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,396 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,396 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,396 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,397 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,397 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,402 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,402 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,402 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,402 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,402 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,403 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,403 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,405 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,405 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,407 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,412 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,413 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,413 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,413 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,413 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,415 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,416 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,417 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,384 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,385 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,385 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,385 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,386 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,386 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,389 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,389 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,389 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,391 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,392 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,392 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,392 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,392 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,393 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,393 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,393 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,397 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,399 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,399 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,399 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,399 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,399 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,401 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,402 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,402 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,402 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,402 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,403 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,403 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,403 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,407 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,409 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,409 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,413 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,417 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,417 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,417 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,417 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,418 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,418 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,423 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,423 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,427 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,427 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,427 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,427 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,429 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,429 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,432 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,436 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,436 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,436 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,436 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,438 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,438 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,438 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,438 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,438 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,438 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,454 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,454 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,457 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,457 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,457 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,459 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,459 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,427 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,432 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,432 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,432 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,432 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,433 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,433 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,436 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,440 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,442 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,442 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,442 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,446 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,447 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,448 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,454 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,456 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,456 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,457 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,457 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,457 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,458 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,460 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,460 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,461 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,462 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,462 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,462 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,462 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,462 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,464 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,464 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,464 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,465 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,465 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,465 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,465 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,465 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,466 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,466 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,468 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,468 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,469 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,475 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,475 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,476 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,476 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,476 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,476 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,476 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,476 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,476 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,477 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,477 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,479 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,479 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,481 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,486 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,487 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,487 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,487 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,487 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,491 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,491 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,491 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,491 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,492 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,492 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,494 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,495 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,496 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,499 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,500 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,500 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,500 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,500 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,501 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,501 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,464 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,464 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,464 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,465 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,465 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,465 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,465 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,466 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,466 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,466 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,468 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,468 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,468 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,469 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,469 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,469 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,471 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,472 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,472 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,472 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,472 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,473 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,475 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,475 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,476 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,481 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,481 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,481 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,481 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,481 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,482 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,482 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,482 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,482 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,483 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,483 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,491 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,495 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,495 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,496 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,496 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,497 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,497 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,500 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,500 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,500 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,502 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,502 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,503 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,503 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,503 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,503 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,503 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,504 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,504 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,506 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,506 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,507 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,507 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,507 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,508 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,508 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,513 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,513 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,513 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,513 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,513 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,514 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,514 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,516 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,516 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,517 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,525 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,525 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,526 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,526 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,526 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,528 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,529 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,530 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,536 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,536 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,540 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,540 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,540 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,540 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,503 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,503 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,503 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,504 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,504 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,504 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,508 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,510 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,510 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,510 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,510 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,510 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,512 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,512 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,513 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,513 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,513 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,514 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,514 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,514 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,518 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,520 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,520 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,525 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,530 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,530 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,530 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,530 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,531 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,531 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,540 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,542 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,542 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,545 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,549 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,549 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,549 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,549 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,550 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,551 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,551 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,551 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,551 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,551 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,566 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,566 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,570 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,570 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,570 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,572 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,572 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,573 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,573 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,573 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,573 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,574 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,574 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,574 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,574 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,576 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,576 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,577 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,577 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,577 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,577 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,577 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,578 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,578 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,578 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,544 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,545 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,545 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,545 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,546 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,546 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,549 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,553 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,555 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,555 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,555 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,559 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,561 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,561 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,566 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,569 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,569 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,570 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,570 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,570 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,570 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,572 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,573 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,573 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,573 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,573 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,574 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,574 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,574 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,574 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,574 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,576 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,576 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,577 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,577 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,577 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,578 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,578 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,578 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,578 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,578 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,580 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,580 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,582 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,587 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,588 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,588 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,588 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,588 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,588 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,588 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,588 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,589 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,589 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,589 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,591 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,591 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,593 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,598 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,599 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,599 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,599 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,599 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,603 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,603 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,604 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,604 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,605 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,605 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,607 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,607 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,608 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,612 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,612 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,613 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,613 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,613 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,614 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,614 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,616 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,616 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,616 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,616 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,616 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,617 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,617 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,619 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,619 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,619 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,619 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,619 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,580 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,580 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,581 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,581 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,581 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,581 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,584 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,584 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,584 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,584 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,584 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,585 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,587 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,587 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,588 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,593 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,594 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,594 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,594 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,594 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,595 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,595 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,595 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,595 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,596 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,596 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,604 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,608 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,608 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,608 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,608 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,609 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,609 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,613 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,613 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,613 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,615 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,615 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,616 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,616 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,616 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,617 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,617 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,617 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,620 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,620 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,626 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,626 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,626 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,626 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,626 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,627 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,627 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,629 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,629 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,631 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,636 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,637 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,637 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,637 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,637 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,639 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,640 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,641 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,647 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,647 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,651 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,651 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,652 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,652 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,653 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,653 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,656 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,621 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,622 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,623 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,623 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,623 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,623 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,625 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,625 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,626 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,626 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,626 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,627 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,627 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,627 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,631 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,633 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,633 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,637 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,641 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,641 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,641 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,641 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,642 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,642 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,652 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,656 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,656 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,656 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,656 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,657 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,657 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,660 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,660 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,661 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,661 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,662 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,662 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,662 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,662 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,662 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,663 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,679 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,679 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,682 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,682 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,682 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,684 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,684 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,685 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,687 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,688 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,689 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,689 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,689 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,689 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,690 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,690 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,690 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,690 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,690 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,693 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,693 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,694 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,661 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,665 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,666 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,666 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,667 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,671 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,672 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,672 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,679 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,681 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,681 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,682 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,682 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,682 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,682 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,685 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,685 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,685 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,686 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,687 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,687 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,689 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,689 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,689 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,689 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,689 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,690 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,690 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,690 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,691 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,691 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,693 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,693 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,693 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,693 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,693 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,694 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,696 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,700 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,700 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,700 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,700 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,701 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,701 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,701 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,701 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,701 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,702 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,702 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,704 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,704 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,705 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,711 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,712 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,712 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,712 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,712 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,716 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,716 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,716 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,716 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,717 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,718 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,720 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,720 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,721 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,725 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,725 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,725 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,725 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,725 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,726 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,726 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,728 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,728 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,729 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,729 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,729 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,729 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,729 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,731 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,732 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,732 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,732 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,732 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,733 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,733 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,696 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,697 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,697 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,697 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,698 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,700 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,700 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,701 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,706 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,706 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,706 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,706 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,706 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,707 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,707 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,707 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,707 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,708 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,708 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,716 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,720 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,721 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,721 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,721 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,722 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,722 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,725 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,725 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,725 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,728 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,728 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,728 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,728 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,728 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,729 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,729 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,730 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,734 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,739 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,739 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,739 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,739 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,739 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,740 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,740 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,742 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,742 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,743 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,749 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,750 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,750 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,750 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,750 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,752 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,753 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,754 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,760 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,760 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,764 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,764 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,764 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,764 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,765 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,766 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,769 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,773 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,773 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,773 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,773 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,735 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,735 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,735 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,736 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,736 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,738 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,738 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,739 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,739 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,739 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,739 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,739 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,740 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,744 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,745 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,745 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,749 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,754 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,754 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,754 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,754 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,755 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,755 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,764 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,768 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,769 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,769 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,769 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,770 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,770 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,773 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(run_dp_rank pid=985582)[0m rank 0 iter time= 0.11 ± 0.00 s (10 samples)
[36m(run_dp_rank pid=985582)[0m rank 0 throughput= 146292.06 tokens/sec (10 samples)
[36m(run_dp_rank pid=985582)[0m rank 0 fwd_p2p_send time= 0.32 ± 0.09 ms (80 samples)
[36m(run_dp_rank pid=985582)[0m rank 0 fwd_p2p_recv time= 0.97 ± 1.31 ms (40 samples)
[36m(run_dp_rank pid=985582)[0m rank 0 bwd_p2p_recv time= 3.19 ± 3.38 ms (80 samples)
[36m(run_dp_rank pid=985582)[0m rank 0 bwd_p2p_send time= 0.22 ± 0.05 ms (40 samples)
[36m(run_dp_rank pid=985582)[0m rank 1 fwd_p2p_recv time= 1.48 ± 1.61 ms (80 samples)
[36m(run_dp_rank pid=985582)[0m rank 1 fwd_p2p_send time= 0.22 ± 0.06 ms (40 samples)
[36m(run_dp_rank pid=985582)[0m rank 1 bwd_p2p_send time= 0.18 ± 0.03 ms (80 samples)
[36m(run_dp_rank pid=985582)[0m rank 1 bwd_p2p_recv time= 1.11 ± 1.27 ms (40 samples)
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,774 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,775 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,775 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,775 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,775 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=985635)[0m 2026-02-18 22:58:01,775 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,777 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,779 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,779 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,779 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,783 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,784 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=985628)[0m 2026-02-18 22:58:01,785 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(run_dp_rank pid=985582)[0m Ray timeline saved to: out/debug-pp2-dp1-interleaved-1f1b.json
[36m(PiperActor pid=985635)[0m [rank1]:[W218 22:58:03.064745650 ProcessGroupNCCL.cpp:1553] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[36m(PiperActor pid=985628)[0m [rank0]:[W218 22:58:03.293190310 ProcessGroupNCCL.cpp:1553] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
