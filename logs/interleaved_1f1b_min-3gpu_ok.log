2026-01-15 01:29:05,200	INFO worker.py:2007 -- Started a local Ray instance.
/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(PiperProgramCoordinator pid=1727201)[0m 2026-01-15 01:29:14,698 - piper_coordinator - INFO - Running program with 1 DP ranks and 2 PP ranks
[36m(run_dp_rank pid=1727200)[0m Namespace(model='LLAMA_DEBUG', schedule='interleaved-1f1b', num_stages=4, dp_degree=1, pp_degree=2, batch_size=16, num_mbs=4, seq_len=256, warmup=1, iters=2, tracing=False, verify_weights=False)
[36m(run_dp_rank pid=1727200)[0m [Debug] Created model
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:22,092 - piper_compile - INFO - DP rank 0 compiling 4 stages...
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:22,141 - piper_backend - DEBUG - Initializing actor for global rank 0
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:25,954 - piper_actor - INFO - Initializing Ray actor 0 global rank 0 with PID: 1727254
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:25,954 - piper_actor - DEBUG - __init__ took 0.16ms
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:25,954 - piper_actor - DEBUG - Initialized actor 0 for global rank 0
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:28,654 - piper_actor - DEBUG - Compiling graph on actor 0 for stage id: 0 with inputs: 22
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:28,665 - piper_actor - DEBUG - compile_graph took 11.30ms
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:29,491 - piper_backend - DEBUG - Thread None global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:29,491 - piper_backend - DEBUG - Thread None global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:29,491 - piper_backend - DEBUG - Thread None global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:29,491 - piper_backend - DEBUG - Thread None global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:29,493 - piper_backend - DEBUG - Initializing actor for global rank 1
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:29,495 - piper_actor - DEBUG - Calling cpu forward 0 mb None on actor 0 global rank 0
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:29,756 - piper_actor - DEBUG - [Debug] 0 forward_no_nccl done
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:33,472 - piper_actor - INFO - Initializing Ray actor 1 global rank 1 with PID: 1727249
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:33,473 - piper_actor - DEBUG - __init__ took 0.18ms
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:33,473 - piper_actor - DEBUG - Initialized actor 1 for global rank 1
[36m(pid=gcs_server)[0m [2026-01-15 01:29:33,457 E 1726535 1726535] (gcs_server) gcs_server.cc:303: Failed to establish connection to the event+metrics exporter agent. Events and metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:35,961 - piper_actor - DEBUG - Compiling graph on actor 1 for stage id: 1 with inputs: 21
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:35,972 - piper_actor - DEBUG - compile_graph took 11.47ms
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:36,100 - piper_backend - DEBUG - Thread None global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:36,100 - piper_backend - DEBUG - Thread None global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:36,100 - piper_backend - DEBUG - Thread None global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:36,100 - piper_backend - DEBUG - Thread None global rank 1 got actor mutex 1
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:36,108 - piper_actor - DEBUG - Calling cpu forward 1 mb None on actor 1 global rank 1
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:36,777 - piper_actor - DEBUG - Compiling graph on actor 0 for stage id: 2 with inputs: 21
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:36,789 - piper_actor - DEBUG - compile_graph took 11.27ms
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:36,913 - piper_backend - DEBUG - Thread None global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:36,913 - piper_backend - DEBUG - Thread None global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:36,913 - piper_backend - DEBUG - Thread None global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:36,913 - piper_backend - DEBUG - Thread None global rank 0 got actor mutex 0
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:36,837 - piper_actor - DEBUG - [Debug] 1 forward_no_nccl done
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:37,720 - piper_backend - DEBUG - Thread None global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:37,720 - piper_backend - DEBUG - Thread None global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:37,720 - piper_backend - DEBUG - Thread None global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:37,720 - piper_backend - DEBUG - Thread None global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:37,768 - piper_compile - INFO - DP rank 0 joining process groups
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,445 - piper_compile - INFO - DP rank 0 completed setup for 2 actors
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:38,444 - piper_actor - DEBUG - Actor 0 global rank 0 has GPU 1, joined the global process group
[36m(run_dp_rank pid=1727200)[0m [Debug] Completed piper_setup
[36m(run_dp_rank pid=1727200)[0m SCHEDULE:
[36m(run_dp_rank pid=1727200)[0m 0:0:f	0:1:f	2:0:f	2:1:f	0:2:f	0:3:f	2:0:b	 -- 	2:1:b	2:2:f	0:0:b	2:3:f	0:1:b	 -- 	2:2:b	2:3:b	0:2:b	0:3:b	0:0:u	
[36m(run_dp_rank pid=1727200)[0m  -- 	1:0:f	1:1:f	3:0:f	3:0:b	3:1:f	3:1:b	1:2:f	1:0:b	1:3:f	1:1:b	3:2:f	3:2:b	3:3:f	3:3:b	1:2:b	1:3:b	1:0:u	 -- 	
[36m(run_dp_rank pid=1727200)[0m [Debug] Sent input and truth to actors
[36m(run_dp_rank pid=1727200)[0m [Debug] Set tracing on actors
[36m(run_dp_rank pid=1727200)[0m Running 1 warmup iterations...
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,827 - piper_compile - INFO - DP rank 0 Started NCCL group with 2 actors
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,840 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,840 - piper_exec - DEBUG - Controller set event for thread 0 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,840 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,841 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,841 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,842 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,842 - piper_exec - DEBUG - Controller set event for thread 0 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,844 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,844 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,844 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,844 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,845 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,846 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,847 - piper_exec - DEBUG - Controller set event for thread 1 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,848 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,848 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,848 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,849 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,849 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,850 - piper_exec - DEBUG - Controller set event for thread 1 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,850 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,850 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,850 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,850 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,851 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,851 - piper_exec - DEBUG - Controller set event for thread 0 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,852 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,852 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,852 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,853 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,854 - piper_exec - DEBUG - Controller set event for thread 0 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,854 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,855 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,855 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,855 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,855 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,856 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,856 - piper_exec - DEBUG - Controller set event for thread 1 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,856 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,857 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,857 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,858 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,858 - piper_exec - DEBUG - Controller waiting for thread 0 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,858 - piper_exec - DEBUG - Controller thread 0 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,858 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,858 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,860 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,861 - piper_exec - DEBUG - Controller set event for thread 2 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,861 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,861 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,861 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,861 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,862 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,862 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,862 - piper_exec - DEBUG - Controller set event for thread 1 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,863 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,863 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,863 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,864 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,864 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,865 - piper_exec - DEBUG - Controller set event for thread 3 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,865 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,865 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,865 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,866 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,866 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,866 - piper_exec - DEBUG - Controller waiting for thread 1 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,867 - piper_exec - DEBUG - Controller thread 1 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,867 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,867 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,868 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,868 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,869 - piper_exec - DEBUG - Controller set event for thread 2 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,869 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,869 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,869 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,871 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,871 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,871 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,871 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,873 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,873 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,875 - piper_exec - DEBUG - Controller set event for thread 3 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,875 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,875 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,875 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,876 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,877 - piper_exec - DEBUG - Controller set event for thread 2 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,877 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,877 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,877 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,877 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,878 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,878 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,878 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,880 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,881 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,881 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,882 - piper_exec - DEBUG - Controller set event for thread 2 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,883 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,883 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,883 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,884 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,884 - piper_exec - DEBUG - Controller set event for thread 3 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,884 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,885 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,885 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,886 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,886 - piper_exec - DEBUG - Controller waiting for thread 2 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,886 - piper_exec - DEBUG - Controller thread 2 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,886 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,886 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,888 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,888 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,888 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,890 - piper_exec - DEBUG - Controller set event for thread 3 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,890 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,890 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,890 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,891 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,891 - piper_exec - DEBUG - Controller waiting for thread 3 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,892 - piper_exec - DEBUG - Controller thread 3 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,892 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,892 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,893 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,893 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,894 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,894 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,896 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,896 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,897 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,897 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,899 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,899 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,900 - piper_exec - DEBUG - Controller updating stage 1 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,901 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,901 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:38,903 - piper_exec - DEBUG - Controller updating stage 0 mb 0
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:38,836 - piper_actor - INFO - Actor 0: Tracing disabled
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:38,842 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0 global rank 0
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:38,884 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0 global rank 0
[33m(raylet)[0m [2026-01-15 01:29:38,859 E 1727056 1727056] (raylet) main.cc:1032: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(PiperProgramCoordinator pid=1727201)[0m [2026-01-15 01:29:39,881 E 1727201 1734490] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[2026-01-15 01:29:40,434 E 1726169 1727199] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:37,731 - piper_actor - DEBUG - Calling cpu forward 3 mb None on actor 1 global rank 1[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:37,628 - piper_actor - DEBUG - Compiling graph on actor 1 for stage id: 3 with inputs: 23
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:37,639 - piper_actor - DEBUG - compile_graph took 11.04ms
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:37,744 - piper_actor - DEBUG - [Debug] 1 forward_no_nccl done[32m [repeated 2x across cluster][0m
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:43,146 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1 global rank 1
[36m(PiperActor pid=1727254)[0m /m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/torch/autograd/graph.py:841: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[36m(PiperActor pid=1727254)[0m   return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:38,444 - piper_actor - DEBUG - Actor 1 global rank 1 has GPU 2, joined the global process group
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:43,489 - piper_actor - DEBUG - Calling update on actor 1 global rank 1
[36m(run_dp_rank pid=1727200)[0m Running 2 timed iterations...
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,936 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,936 - piper_exec - DEBUG - Controller set event for thread 0 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,936 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,936 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,937 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,938 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,938 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,938 - piper_exec - DEBUG - Controller set event for thread 0 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,938 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,938 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,938 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,939 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,940 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,941 - piper_exec - DEBUG - Controller set event for thread 1 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,941 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,941 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,942 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,942 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,943 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,943 - piper_exec - DEBUG - Controller set event for thread 1 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,943 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,943 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,943 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,943 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,944 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,944 - piper_exec - DEBUG - Controller set event for thread 0 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,944 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,945 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,945 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,945 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,946 - piper_exec - DEBUG - Controller set event for thread 0 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,947 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,947 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,947 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,948 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,948 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,948 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,949 - piper_exec - DEBUG - Controller set event for thread 1 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,949 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,949 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,949 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,950 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,950 - piper_exec - DEBUG - Controller waiting for thread 0 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,951 - piper_exec - DEBUG - Controller thread 0 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,951 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,951 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,953 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,954 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,954 - piper_exec - DEBUG - Controller set event for thread 2 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,955 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,955 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,955 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,956 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,956 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,956 - piper_exec - DEBUG - Controller set event for thread 1 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,956 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,956 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,956 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,957 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,958 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,958 - piper_exec - DEBUG - Controller set event for thread 3 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,959 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,959 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,959 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,960 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,960 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,961 - piper_exec - DEBUG - Controller waiting for thread 1 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,961 - piper_exec - DEBUG - Controller thread 1 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,961 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,961 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,963 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,963 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 0
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:38,837 - piper_actor - INFO - Actor 1: Tracing disabled
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:43,376 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1 global rank 1[32m [repeated 14x across cluster][0m
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,964 - piper_exec - DEBUG - Controller set event for thread 2 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,964 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,964 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,964 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,965 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,966 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,966 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,966 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,969 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,969 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,971 - piper_exec - DEBUG - Controller set event for thread 3 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,972 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,972 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,972 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,973 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,973 - piper_exec - DEBUG - Controller set event for thread 2 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,973 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,974 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,974 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,974 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,975 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,975 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,975 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,978 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,978 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,979 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,980 - piper_exec - DEBUG - Controller set event for thread 2 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,980 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,980 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,980 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,982 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,982 - piper_exec - DEBUG - Controller set event for thread 3 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,982 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,982 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,982 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,983 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,983 - piper_exec - DEBUG - Controller waiting for thread 2 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,985 - piper_exec - DEBUG - Controller thread 2 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,985 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,985 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,987 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,988 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,988 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,989 - piper_exec - DEBUG - Controller set event for thread 3 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,989 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,989 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,990 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,991 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,991 - piper_exec - DEBUG - Controller waiting for thread 3 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,991 - piper_exec - DEBUG - Controller thread 3 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,991 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,991 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,992 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,993 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,994 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,994 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,995 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,995 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,997 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,997 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,999 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:43,999 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,001 - piper_exec - DEBUG - Controller updating stage 1 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,001 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,001 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,002 - piper_exec - DEBUG - Controller updating stage 0 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,097 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,097 - piper_exec - DEBUG - Controller set event for thread 0 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,098 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,098 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,098 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,099 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,100 - piper_exec - DEBUG - Controller set event for thread 0 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,100 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,100 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,100 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,100 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,101 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,102 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,102 - piper_exec - DEBUG - Controller set event for thread 1 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,103 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,103 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,103 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,104 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,105 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,105 - piper_exec - DEBUG - Controller set event for thread 1 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,105 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,105 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,105 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,105 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,106 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,107 - piper_exec - DEBUG - Controller set event for thread 0 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,107 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,107 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,107 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,108 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,109 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,109 - piper_exec - DEBUG - Controller set event for thread 0 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,110 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,110 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,110 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,110 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,111 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,111 - piper_exec - DEBUG - Controller set event for thread 1 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,112 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,112 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,112 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,113 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,113 - piper_exec - DEBUG - Controller waiting for thread 0 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,113 - piper_exec - DEBUG - Controller thread 0 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,113 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,113 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,116 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,117 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,117 - piper_exec - DEBUG - Controller set event for thread 2 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,117 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,118 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,118 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,118 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,119 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,119 - piper_exec - DEBUG - Controller set event for thread 1 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,119 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,119 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,119 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,120 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,121 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,121 - piper_exec - DEBUG - Controller set event for thread 3 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,122 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,122 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,122 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,123 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,123 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,124 - piper_exec - DEBUG - Controller waiting for thread 1 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,124 - piper_exec - DEBUG - Controller thread 1 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,124 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,124 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,125 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,126 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,128 - piper_exec - DEBUG - Controller set event for thread 2 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,128 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,128 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,128 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,129 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,130 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,131 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,131 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,132 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,133 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,134 - piper_exec - DEBUG - Controller set event for thread 3 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,134 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,134 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,134 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,135 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,136 - piper_exec - DEBUG - Controller set event for thread 2 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,136 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,136 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,136 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,136 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,138 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,138 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,138 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,138 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,140 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,140 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,142 - piper_exec - DEBUG - Controller set event for thread 2 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,142 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,142 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,142 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,143 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,143 - piper_exec - DEBUG - Controller set event for thread 3 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,143 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,143 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,143 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,145 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,146 - piper_exec - DEBUG - Controller waiting for thread 2 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,147 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,147 - piper_exec - DEBUG - Controller thread 2 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,147 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,147 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,148 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,148 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,150 - piper_exec - DEBUG - Controller set event for thread 3 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,150 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,150 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,150 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,151 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,151 - piper_exec - DEBUG - Controller waiting for thread 3 to join
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,152 - piper_exec - DEBUG - Controller thread 3 joined
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,152 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,152 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,153 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,153 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,155 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,155 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,156 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,156 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,158 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,158 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,160 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,160 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 2
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,162 - piper_exec - DEBUG - Controller updating stage 1 mb 0
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,162 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,162 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 3
[36m(run_dp_rank pid=1727200)[0m 2026-01-15 01:29:44,164 - piper_exec - DEBUG - Controller updating stage 0 mb 0
[36m(run_dp_rank pid=1727200)[0m Iteration time: 160 ms
[36m(run_dp_rank pid=1727200)[0m interleaved-1f1b throughput: 102518 tokens/sec
[36m(pid=1734476)[0m [2026-01-15 01:29:40,418 E 1734476 1741332] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14[32m [repeated 255x across cluster][0m
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:44,239 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0 global rank 0[32m [repeated 47x across cluster][0m
[36m(PiperActor pid=1727254)[0m 2026-01-15 01:29:44,247 - piper_actor - DEBUG - Calling update on actor 0 global rank 0[32m [repeated 5x across cluster][0m
[36m(PiperActor pid=1727249)[0m 2026-01-15 01:29:44,204 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1 global rank 1[32m [repeated 32x across cluster][0m
