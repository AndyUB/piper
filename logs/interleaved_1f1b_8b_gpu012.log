2026-01-21 09:49:55,699	INFO worker.py:2007 -- Started a local Ray instance.
/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(PiperProgramCoordinator pid=2296058)[0m 2026-01-21 09:50:05,634 - piper_coordinator - INFO - Running program with 1 DP ranks and 2 PP ranks
[36m(run_dp_rank pid=2296057)[0m Namespace(model='LLAMA_8B', schedule='interleaved-1f1b', num_stages=4, dp_degree=1, pp_degree=2, batch_size=16, num_mbs=4, seq_len=256, warmup=5, iters=5, tracing=False, verify_weights=False)
[36m(pid=gcs_server)[0m [2026-01-21 09:50:23,965 E 2295424 2295424] (gcs_server) gcs_server.cc:303: Failed to establish connection to the event+metrics exporter agent. Events and metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[33m(raylet)[0m [2026-01-21 09:50:29,986 E 2295902 2295902] (raylet) main.cc:1032: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(PiperProgramCoordinator pid=2296058)[0m [2026-01-21 09:50:31,007 E 2296058 2303444] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[2026-01-21 09:50:31,569 E 2295255 2296048] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(run_dp_rank pid=2296057)[0m 2026-01-21 09:51:04,248 - piper_compile - INFO - DP rank 0 compiling 4 stages...
[36m(pid=2303440)[0m [2026-01-21 09:50:31,554 E 2303440 2310094] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14[32m [repeated 255x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(PiperActor pid=2296049)[0m 2026-01-21 09:51:08,146 - piper_actor - INFO - Initializing Ray actor 0 global rank 0 with PID: 2296049
[36m(PiperActor pid=2296050)[0m 2026-01-21 09:51:39,671 - piper_actor - INFO - Initializing Ray actor 1 global rank 1 with PID: 2296050
[36m(run_dp_rank pid=2296057)[0m 2026-01-21 09:52:27,609 - piper_compile - INFO - DP rank 0 joining process groups
[36m(run_dp_rank pid=2296057)[0m 2026-01-21 09:52:27,627 - piper_compile - INFO - DP rank 0 completed setup for 2 actors
[36m(run_dp_rank pid=2296057)[0m SCHEDULE:
[36m(run_dp_rank pid=2296057)[0m 0:0:f	0:1:f	2:0:f	2:1:f	0:2:f	0:3:f	2:0:b	 -- 	2:1:b	2:2:f	0:0:b	2:3:f	0:1:b	 -- 	2:2:b	2:3:b	0:2:b	0:3:b	0:0:u	
[36m(run_dp_rank pid=2296057)[0m  -- 	1:0:f	1:1:f	3:0:f	3:0:b	3:1:f	3:1:b	1:2:f	1:0:b	1:3:f	1:1:b	3:2:f	3:2:b	3:3:f	3:3:b	1:2:b	1:3:b	1:0:u	 -- 	
[36m(run_dp_rank pid=2296057)[0m Running 5 warmup iterations...
[36m(run_dp_rank pid=2296057)[0m 2026-01-21 09:52:27,997 - piper_compile - INFO - DP rank 0 Started NCCL group with 2 actors
[36m(PiperActor pid=2296049)[0m 2026-01-21 09:52:28,034 - piper_actor - INFO - Actor 0: Tracing disabled
[36m(run_dp_rank pid=2296057)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::PiperActor.backward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 247, in forward
[36m(run_dp_rank pid=2296057)[0m     out = self.compiled_fns[stage_id](*self.parameters[stage_id])
[36m(run_dp_rank pid=2296057)[0m   File "<eval_with_key>.0", line 67, in forward
[36m(run_dp_rank pid=2296057)[0m     silu = torch.nn.functional.silu(linear_4);  linear_4 = None
[36m(run_dp_rank pid=2296057)[0m   File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/torch/nn/functional.py", line 2371, in silu
[36m(run_dp_rank pid=2296057)[0m     return torch._C._nn.silu(input)
[36m(run_dp_rank pid=2296057)[0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 224.00 MiB. GPU 0 has a total capacity of 139.81 GiB of which 215.44 MiB is free. Including non-PyTorch memory, this process has 139.59 GiB memory in use. Of the allocated memory 137.59 GiB is allocated by PyTorch, and 361.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[36m(PiperActor pid=2296050)[0m 2026-01-21 09:52:28,034 - piper_actor - INFO - Actor 1: Tracing disabled
Traceback (most recent call last):
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/test/test_llama.py", line 274, in <module>
    ray.get(piper_coordinator.run_program.remote(main, args))
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py", line 2967, in get
    values, debugger_breakpoint = worker.get_objects(
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py", line 1015, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(OutOfMemoryError): [36mray::PiperProgramCoordinator.run_program()[39m (pid=2296058, ip=10.158.48.71, actor_id=226a364ac1e046d03720ea2c01000000, repr=<src.piper_coordinator.PiperProgramCoordinator object at 0x7ff676d22e60>)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_coordinator.py", line 41, in run_program
    ret = ray.get([run_dp_rank.remote(
ray.exceptions.RayTaskError(OutOfMemoryError): [36mray::run_dp_rank()[39m (pid=2296057, ip=10.158.48.71)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_coordinator.py", line 21, in run_dp_rank
    return training_func(*args, **kwargs)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/test/test_llama.py", line 226, in main
    iter_schedule()
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/test/test_llama.py", line 217, in iter_schedule
    ray.get(out)
ray.exceptions.RayTaskError(OutOfMemoryError): [36mray::PiperActor.update()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 247, in forward
    out = self.compiled_fns[stage_id](*self.parameters[stage_id])
  File "<eval_with_key>.0", line 67, in forward
    silu = torch.nn.functional.silu(linear_4);  linear_4 = None
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/torch/nn/functional.py", line 2371, in silu
    return torch._C._nn.silu(input)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 224.00 MiB. GPU 0 has a total capacity of 139.81 GiB of which 215.44 MiB is free. Including non-PyTorch memory, this process has 139.59 GiB memory in use. Of the allocated memory 137.59 GiB is allocated by PyTorch, and 361.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[36m(run_dp_rank pid=2296057)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::PiperActor.backward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 247, in forward
[36m(run_dp_rank pid=2296057)[0m     out = self.compiled_fns[stage_id](*self.parameters[stage_id])
[36m(run_dp_rank pid=2296057)[0m   File "<eval_with_key>.0", line 67, in forward
[36m(run_dp_rank pid=2296057)[0m     silu = torch.nn.functional.silu(linear_4);  linear_4 = None
[36m(run_dp_rank pid=2296057)[0m   File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/torch/nn/functional.py", line 2371, in silu
[36m(run_dp_rank pid=2296057)[0m     return torch._C._nn.silu(input)
[36m(run_dp_rank pid=2296057)[0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 224.00 MiB. GPU 0 has a total capacity of 139.81 GiB of which 215.44 MiB is free. Including non-PyTorch memory, this process has 139.59 GiB memory in use. Of the allocated memory 137.59 GiB is allocated by PyTorch, and 361.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[36m(run_dp_rank pid=2296057)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::PiperActor.backward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 247, in forward
[36m(run_dp_rank pid=2296057)[0m     out = self.compiled_fns[stage_id](*self.parameters[stage_id])
[36m(run_dp_rank pid=2296057)[0m   File "<eval_with_key>.0", line 67, in forward
[36m(run_dp_rank pid=2296057)[0m     silu = torch.nn.functional.silu(linear_4);  linear_4 = None
[36m(run_dp_rank pid=2296057)[0m   File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/torch/nn/functional.py", line 2371, in silu
[36m(run_dp_rank pid=2296057)[0m     return torch._C._nn.silu(input)
[36m(run_dp_rank pid=2296057)[0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 224.00 MiB. GPU 0 has a total capacity of 139.81 GiB of which 215.44 MiB is free. Including non-PyTorch memory, this process has 139.59 GiB memory in use. Of the allocated memory 137.59 GiB is allocated by PyTorch, and 361.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[36m(run_dp_rank pid=2296057)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::PiperActor.update()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.backward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296050, ip=10.158.48.71, actor_id=4a11efec73abbbdaee0c7b9001000000, repr=<src.piper_actor.PiperActor object at 0x7f603c6b2740>)
[36m(run_dp_rank pid=2296057)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2296057)[0m ray.exceptions.RayTaskError: [36mray::PiperActor.forward()[39m (pid=2296049, ip=10.158.48.71, actor_id=aace0610b06414ed332c6e1c01000000, repr=<src.piper_actor.PiperActor object at 0x7f582ec4e710>)
[36m(run_dp_rank pid=2296057)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 247, in forward
[36m(run_dp_rank pid=2296057)[0m     out = self.compiled_fns[stage_id](*self.parameters[stage_id])
[36m(run_dp_rank pid=2296057)[0m   File "<eval_with_key>.0", line 67, in forward
[36m(run_dp_rank pid=2296057)[0m     silu = torch.nn.functional.silu(linear_4);  linear_4 = None
[36m(run_dp_rank pid=2296057)[0m   File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/torch/nn/functional.py", line 2371, in silu
[36m(run_dp_rank pid=2296057)[0m     return torch._C._nn.silu(input)
[36m(run_dp_rank pid=2296057)[0m torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 224.00 MiB. GPU 0 has a total capacity of 139.81 GiB of which 215.44 MiB is free. Including non-PyTorch memory, this process has 139.59 GiB memory in use. Of the allocated memory 137.59 GiB is allocated by PyTorch, and 361.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
