2026-01-21 18:27:53,457	INFO worker.py:2007 -- Started a local Ray instance.
/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
session_dir = /home/wxdeng/ray_tmp/ray/session_2026-01-21_18-27-48_386887_3058425
logs_dir    = /home/wxdeng/ray_tmp/ray/session_2026-01-21_18-27-48_386887_3058425/logs
[36m(PiperProgramCoordinator pid=3059316)[0m 2026-01-21 18:28:03,313 - piper_coordinator - INFO - Running program with 1 DP ranks and 2 PP ranks
[36m(run_dp_rank pid=3059319)[0m Namespace(model='LLAMA_3B', schedule='1f1b', num_stages=2, dp_degree=1, pp_degree=2, batch_size=16, num_mbs=4, seq_len=256, warmup=5, iters=5, tracing=False, verify_weights=False)
[36m(pid=gcs_server)[0m [2026-01-21 18:28:21,631 E 3058570 3058570] (gcs_server) gcs_server.cc:303: Failed to establish connection to the event+metrics exporter agent. Events and metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[33m(raylet)[0m [2026-01-21 18:28:27,465 E 3059123 3059123] (raylet) main.cc:1032: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(PiperProgramCoordinator pid=3059316)[0m [2026-01-21 18:28:28,485 E 3059316 3066554] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[2026-01-21 18:28:29,022 E 3058425 3059270] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(run_dp_rank pid=3059319)[0m 2026-01-21 18:28:33,909 - piper_compile - INFO - DP rank 0 compiling 2 stages...
[36m(pid=3066550)[0m [2026-01-21 18:28:29,007 E 3066550 3073258] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14[32m [repeated 255x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[33m(raylet)[0m WARNING: Device-side CUDA Event completion trace is currently enabled.
[33m(raylet)[0m          This may increase runtime overhead and the likelihood of false
[33m(raylet)[0m          dependencies across CUDA Streams. If you wish to avoid this, please
[33m(raylet)[0m          disable the feature with --cuda-event-trace=false.
[36m(PiperActor pid=3081677)[0m 2026-01-21 18:29:15,697 - piper_actor - INFO - Initializing Ray actor 0 global rank 0 with PID: 3081677
[33m(raylet)[0m WARNING: Device-side CUDA Event completion trace is currently enabled.
[33m(raylet)[0m          This may increase runtime overhead and the likelihood of false
[33m(raylet)[0m          dependencies across CUDA Streams. If you wish to avoid this, please
[33m(raylet)[0m          disable the feature with --cuda-event-trace=false.
[36m(PiperActor pid=3081677)[0m [2026-01-21 18:29:41,862 E 3081677 3082388] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(PiperActor pid=3085908)[0m 2026-01-21 18:29:47,820 - piper_actor - INFO - Initializing Ray actor 1 global rank 1 with PID: 3085908
[36m(run_dp_rank pid=3059319)[0m 2026-01-21 18:30:04,178 - piper_compile - INFO - DP rank 0 joining process groups
[36m(run_dp_rank pid=3059319)[0m 2026-01-21 18:30:04,188 - piper_compile - INFO - DP rank 0 completed setup for 2 actors
[36m(run_dp_rank pid=3059319)[0m SCHEDULE:
[36m(run_dp_rank pid=3059319)[0m 0:0:f	0:1:f	0:2:f	0:0:b	0:3:f	0:1:b	 -- 	0:2:b	 -- 	0:3:b	0:3:u	
[36m(run_dp_rank pid=3059319)[0m  -- 	1:0:f	1:0:b	1:1:f	1:1:b	1:2:f	1:2:b	1:3:f	1:3:b	1:3:u	 -- 	
[36m(run_dp_rank pid=3059319)[0m Running 5 warmup iterations...
[36m(run_dp_rank pid=3059319)[0m 2026-01-21 18:30:04,608 - piper_compile - INFO - DP rank 0 Started NCCL group with 2 actors
[36m(PiperActor pid=3081677)[0m 2026-01-21 18:30:04,655 - piper_actor - INFO - Actor 0: Tracing disabled
[33m(raylet)[0m WARNING: Device-side CUDA Event completion trace is currently enabled.
[33m(raylet)[0m          This may increase runtime overhead and the likelihood of false
[33m(raylet)[0m          dependencies across CUDA Streams. If you wish to avoid this, please
[33m(raylet)[0m          disable the feature with --cuda-event-trace=false.
[36m(PiperActor pid=3085908)[0m [2026-01-21 18:30:13,801 E 3085908 3086688] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(PiperActor pid=3085908)[0m 2026-01-21 18:30:04,655 - piper_actor - INFO - Actor 1: Tracing disabled
[36m(run_dp_rank pid=3059319)[0m Running 5 timed iterations...
[36m(NCCLUniqueIDStore pid=3093070)[0m [2026-01-21 18:30:51,175 E 3093070 3095716] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(run_dp_rank pid=3059319)[0m Iteration time: 4570 ms
[36m(run_dp_rank pid=3059319)[0m 1f1b throughput: 3585 tokens/sec
