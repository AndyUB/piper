2026-01-15 01:10:39,639	INFO worker.py:2007 -- Started a local Ray instance.
/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(PiperProgramCoordinator pid=1621474)[0m 2026-01-15 01:10:49,276 - piper_coordinator - INFO - Running program with 1 DP ranks and 2 PP ranks
[36m(run_dp_rank pid=1621463)[0m Namespace(model='LLAMA_DEBUG', schedule='interleaved-1f1b', num_stages=4, dp_degree=1, pp_degree=2, batch_size=16, num_mbs=4, seq_len=256, warmup=1, iters=2, tracing=False, verify_weights=False)
[36m(run_dp_rank pid=1621463)[0m [Debug] Created model
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:10:56,525 - piper_compile - INFO - DP rank 0 compiling 4 stages...
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:10:56,573 - piper_backend - DEBUG - Initializing actor for global rank 0
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:00,615 - piper_actor - INFO - Initializing Ray actor 0 global rank 0 with PID: 1621450
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:00,615 - piper_actor - DEBUG - __init__ took 0.21ms
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:00,615 - piper_actor - DEBUG - Initialized actor 0 for global rank 0
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:03,260 - piper_actor - DEBUG - Compiling graph on actor 0 for stage id: 0 with inputs: 22
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:03,272 - piper_actor - DEBUG - compile_graph took 11.83ms
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:04,084 - piper_backend - DEBUG - Thread None global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:04,084 - piper_backend - DEBUG - Thread None global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:04,084 - piper_backend - DEBUG - Thread None global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:04,084 - piper_backend - DEBUG - Thread None global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:04,086 - piper_backend - DEBUG - Initializing actor for global rank 1
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:04,089 - piper_actor - DEBUG - Calling cpu forward 0 mb None on actor 0 global rank 0
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:04,869 - piper_actor - DEBUG - [Debug] 0 forward_no_nccl done
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:07,878 - piper_actor - INFO - Initializing Ray actor 1 global rank 1 with PID: 1621483
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:07,878 - piper_actor - DEBUG - __init__ took 0.15ms
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:07,878 - piper_actor - DEBUG - Initialized actor 1 for global rank 1
[36m(pid=gcs_server)[0m [2026-01-15 01:11:07,987 E 1620776 1620776] (gcs_server) gcs_server.cc:303: Failed to establish connection to the event+metrics exporter agent. Events and metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:10,603 - piper_actor - DEBUG - Compiling graph on actor 1 for stage id: 1 with inputs: 21
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:10,614 - piper_actor - DEBUG - compile_graph took 10.91ms
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:10,728 - piper_backend - DEBUG - Thread None global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:10,729 - piper_backend - DEBUG - Thread None global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:10,729 - piper_backend - DEBUG - Thread None global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:10,729 - piper_backend - DEBUG - Thread None global rank 1 got actor mutex 1
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:10,735 - piper_actor - DEBUG - Calling cpu forward 1 mb None on actor 1 global rank 1
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:11,373 - piper_actor - DEBUG - Compiling graph on actor 0 for stage id: 2 with inputs: 21
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:11,384 - piper_actor - DEBUG - compile_graph took 10.68ms
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:11,486 - piper_backend - DEBUG - Thread None global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:11,486 - piper_backend - DEBUG - Thread None global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:11,486 - piper_backend - DEBUG - Thread None global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:11,486 - piper_backend - DEBUG - Thread None global rank 0 got actor mutex 0
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:11,530 - piper_actor - DEBUG - [Debug] 0 forward_no_nccl done
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,286 - piper_backend - DEBUG - Thread None global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,286 - piper_backend - DEBUG - Thread None global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,286 - piper_backend - DEBUG - Thread None global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,286 - piper_backend - DEBUG - Thread None global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,319 - piper_compile - INFO - DP rank 0 joining process groups
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,339 - piper_compile - INFO - DP rank 0 completed setup for 2 actors
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:12,337 - piper_actor - DEBUG - Actor 0 global rank 0 has GPU 1, joined the global process group
[36m(run_dp_rank pid=1621463)[0m [Debug] Completed piper_setup
[36m(run_dp_rank pid=1621463)[0m SCHEDULE:
[36m(run_dp_rank pid=1621463)[0m 0:0:f	0:1:f	2:0:f	2:1:f	0:2:f	0:3:f	2:0:b	 -- 	2:1:b	2:2:f	0:0:b	2:3:f	0:1:b	 -- 	2:2:b	2:3:b	0:2:b	0:3:b	0:0:u	
[36m(run_dp_rank pid=1621463)[0m  -- 	1:0:f	1:1:f	3:0:f	3:0:b	3:1:f	3:1:b	1:2:f	1:0:b	1:3:f	1:1:b	3:2:f	3:2:b	3:3:f	3:3:b	1:2:b	1:3:b	1:0:u	 -- 	
[36m(run_dp_rank pid=1621463)[0m [Debug] Sent input and truth to actors
[36m(run_dp_rank pid=1621463)[0m [Debug] Set tracing on actors
[36m(run_dp_rank pid=1621463)[0m Running 1 warmup iterations...
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,920 - piper_compile - INFO - DP rank 0 Started NCCL group with 2 actors
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:12,930 - piper_actor - INFO - Actor 0: Tracing disabled
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,933 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,933 - piper_exec - DEBUG - Controller set event for thread 0 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,934 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,934 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,934 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,935 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,935 - piper_exec - DEBUG - Controller set event for thread 0 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,938 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,938 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,938 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,938 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,938 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,939 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,940 - piper_exec - DEBUG - Controller set event for thread 1 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,941 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,942 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,942 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,942 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,942 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,943 - piper_exec - DEBUG - Controller set event for thread 1 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,943 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,943 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,943 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,943 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,944 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,944 - piper_exec - DEBUG - Controller set event for thread 0 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,944 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,945 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,945 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:12,935 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0 global rank 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,945 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,946 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,946 - piper_exec - DEBUG - Controller set event for thread 0 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,947 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,947 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,947 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,947 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,947 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,947 - piper_exec - DEBUG - Controller set event for thread 1 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,948 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,948 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,948 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,949 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,949 - piper_exec - DEBUG - Controller waiting for thread 0 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,950 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,950 - piper_exec - DEBUG - Controller thread 0 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,951 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,951 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,953 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,953 - piper_exec - DEBUG - Controller set event for thread 2 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,953 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,953 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,953 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,954 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,954 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,954 - piper_exec - DEBUG - Controller set event for thread 1 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,955 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,955 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,955 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,956 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,957 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,957 - piper_exec - DEBUG - Controller set event for thread 3 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,957 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,957 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,957 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,958 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,958 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,958 - piper_exec - DEBUG - Controller waiting for thread 1 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,959 - piper_exec - DEBUG - Controller thread 1 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,959 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,959 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,960 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,960 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,961 - piper_exec - DEBUG - Controller set event for thread 2 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,961 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,961 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,961 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,962 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,963 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,963 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,963 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,965 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,965 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,966 - piper_exec - DEBUG - Controller set event for thread 3 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,966 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,966 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,966 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,967 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,968 - piper_exec - DEBUG - Controller set event for thread 2 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,968 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,968 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,968 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,968 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,969 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,970 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,970 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,971 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,972 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,972 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,973 - piper_exec - DEBUG - Controller set event for thread 2 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,973 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,973 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,973 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,975 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,975 - piper_exec - DEBUG - Controller set event for thread 3 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,975 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,975 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,975 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,976 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,976 - piper_exec - DEBUG - Controller waiting for thread 2 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,976 - piper_exec - DEBUG - Controller thread 2 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,976 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,976 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,978 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,978 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,978 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,980 - piper_exec - DEBUG - Controller set event for thread 3 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,980 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,980 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,980 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,981 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,982 - piper_exec - DEBUG - Controller waiting for thread 3 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,982 - piper_exec - DEBUG - Controller thread 3 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,982 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,982 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,983 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,983 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,984 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,984 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,986 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,986 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,987 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,987 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,988 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,988 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,989 - piper_exec - DEBUG - Controller updating stage 1 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,990 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,990 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:12,991 - piper_exec - DEBUG - Controller updating stage 0 mb 0
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:13,147 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0 global rank 0
[33m(raylet)[0m [2026-01-15 01:11:13,304 E 1621285 1621285] (raylet) main.cc:1032: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(PiperProgramCoordinator pid=1621474)[0m [2026-01-15 01:11:14,326 E 1621474 1628894] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[2026-01-15 01:11:14,877 E 1620455 1621433] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:12,296 - piper_actor - DEBUG - Calling cpu forward 3 mb None on actor 1 global rank 1[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:12,200 - piper_actor - DEBUG - Compiling graph on actor 1 for stage id: 3 with inputs: 23
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:12,211 - piper_actor - DEBUG - compile_graph took 11.01ms
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:12,303 - piper_actor - DEBUG - [Debug] 1 forward_no_nccl done[32m [repeated 2x across cluster][0m
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:12,337 - piper_actor - DEBUG - Actor 1 global rank 1 has GPU 2, joined the global process group
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:17,629 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1 global rank 1
[36m(PiperActor pid=1621450)[0m /m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/torch/autograd/graph.py:841: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:270.)
[36m(PiperActor pid=1621450)[0m   return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:12,930 - piper_actor - INFO - Actor 1: Tracing disabled
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:17,831 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1 global rank 1[32m [repeated 9x across cluster][0m
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:18,564 - piper_actor - DEBUG - Calling update on actor 0 global rank 0
[36m(run_dp_rank pid=1621463)[0m Running 2 timed iterations...
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,708 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,709 - piper_exec - DEBUG - Controller set event for thread 0 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,709 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,709 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,709 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,710 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,710 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,710 - piper_exec - DEBUG - Controller set event for thread 0 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,710 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,710 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,710 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,711 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,712 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,713 - piper_exec - DEBUG - Controller set event for thread 1 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,713 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,713 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,713 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,713 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,715 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,715 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,715 - piper_exec - DEBUG - Controller set event for thread 1 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,715 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,715 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,715 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,716 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,717 - piper_exec - DEBUG - Controller set event for thread 0 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,717 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,717 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,717 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,717 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,718 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,718 - piper_exec - DEBUG - Controller set event for thread 0 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,719 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,719 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,719 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,719 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,719 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,720 - piper_exec - DEBUG - Controller set event for thread 1 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,720 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,720 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,720 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,721 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,721 - piper_exec - DEBUG - Controller waiting for thread 0 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,722 - piper_exec - DEBUG - Controller thread 0 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,722 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,722 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,724 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,725 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,725 - piper_exec - DEBUG - Controller set event for thread 2 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,725 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,725 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,725 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,726 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,727 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,727 - piper_exec - DEBUG - Controller set event for thread 1 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,727 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,727 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,727 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,728 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,729 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,730 - piper_exec - DEBUG - Controller set event for thread 3 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,730 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,731 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,731 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,732 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,732 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,732 - piper_exec - DEBUG - Controller waiting for thread 1 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,732 - piper_exec - DEBUG - Controller thread 1 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,732 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,733 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,734 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,734 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,735 - piper_exec - DEBUG - Controller set event for thread 2 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,735 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,735 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,735 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,736 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,736 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,738 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,738 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,740 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,740 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,741 - piper_exec - DEBUG - Controller set event for thread 3 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,741 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,741 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,742 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,743 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,743 - piper_exec - DEBUG - Controller set event for thread 2 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,743 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,743 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,743 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,744 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,744 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,745 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,745 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,746 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,747 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,747 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,749 - piper_exec - DEBUG - Controller set event for thread 2 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,749 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,749 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,749 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,750 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,750 - piper_exec - DEBUG - Controller set event for thread 3 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,750 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,751 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,751 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,752 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,752 - piper_exec - DEBUG - Controller waiting for thread 2 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,752 - piper_exec - DEBUG - Controller thread 2 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,752 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,752 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,754 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,754 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,755 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,756 - piper_exec - DEBUG - Controller set event for thread 3 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,756 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,756 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,756 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,757 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,757 - piper_exec - DEBUG - Controller waiting for thread 3 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,758 - piper_exec - DEBUG - Controller thread 3 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,758 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,758 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,759 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,759 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,760 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,760 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,761 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,761 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,762 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,762 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,765 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,765 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,766 - piper_exec - DEBUG - Controller updating stage 1 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,766 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,766 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:18,768 - piper_exec - DEBUG - Controller updating stage 0 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,290 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,290 - piper_exec - DEBUG - Controller set event for thread 0 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,290 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,291 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,291 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,292 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,292 - piper_exec - DEBUG - Controller set event for thread 0 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,292 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,293 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,293 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,293 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,294 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,295 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,296 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,296 - piper_exec - DEBUG - Controller set event for thread 1 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,296 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,296 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,296 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,297 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,297 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,297 - piper_exec - DEBUG - Controller set event for thread 1 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,297 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,298 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,298 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,299 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,299 - piper_exec - DEBUG - Controller set event for thread 0 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,299 - piper_backend - DEBUG - Thread 0 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,299 - piper_backend - DEBUG - Thread 0 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,299 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,299 - piper_backend - DEBUG - Thread 0 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,300 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,300 - piper_exec - DEBUG - Controller set event for thread 0 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,301 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,301 - piper_backend - DEBUG - Thread 0 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,301 - piper_backend - DEBUG - Thread 0 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,301 - piper_backend - DEBUG - Thread 0 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,303 - piper_exec - DEBUG - Controller: thread 0 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,303 - piper_exec - DEBUG - Controller set event for thread 1 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,303 - piper_backend - DEBUG - Thread 1 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,303 - piper_backend - DEBUG - Thread 1 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,303 - piper_backend - DEBUG - Thread 1 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,304 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,304 - piper_exec - DEBUG - Controller waiting for thread 0 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,304 - piper_exec - DEBUG - Controller thread 0 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,304 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,305 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,306 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,307 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,307 - piper_exec - DEBUG - Controller set event for thread 2 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,307 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,308 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,308 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,309 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,309 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,309 - piper_exec - DEBUG - Controller set event for thread 1 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,309 - piper_backend - DEBUG - Thread 1 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,309 - piper_backend - DEBUG - Thread 1 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,309 - piper_backend - DEBUG - Thread 1 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,310 - piper_exec - DEBUG - Controller: thread 1 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,311 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,311 - piper_exec - DEBUG - Controller set event for thread 3 stage 0: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,312 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,312 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,312 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,313 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,313 - piper_exec - DEBUG - Controller waiting for thread 1 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,313 - piper_exec - DEBUG - Controller thread 1 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,313 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,313 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,315 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,315 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,315 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,317 - piper_exec - DEBUG - Controller set event for thread 2 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,317 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,317 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,317 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,318 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,319 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,320 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,320 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,322 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,322 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,323 - piper_exec - DEBUG - Controller set event for thread 3 stage 1: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,323 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,323 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,323 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,324 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,324 - piper_exec - DEBUG - Controller set event for thread 2 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,325 - piper_backend - DEBUG - Thread 2 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,325 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,325 - piper_backend - DEBUG - Thread 2 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,325 - piper_backend - DEBUG - Thread 2 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,326 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,327 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,327 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,329 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,330 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,330 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,331 - piper_exec - DEBUG - Controller set event for thread 2 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,331 - piper_backend - DEBUG - Thread 2 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,331 - piper_backend - DEBUG - Thread 2 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,331 - piper_backend - DEBUG - Thread 2 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,332 - piper_exec - DEBUG - Controller: thread 2 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,333 - piper_exec - DEBUG - Controller set event for thread 3 stage 2: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,333 - piper_backend - DEBUG - Thread 3 global rank 0 running stage 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,333 - piper_backend - DEBUG - Thread 3 global rank 0 waiting for actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,334 - piper_backend - DEBUG - Thread 3 global rank 0 got actor mutex 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,334 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,335 - piper_exec - DEBUG - Controller waiting for thread 2 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,335 - piper_exec - DEBUG - Controller thread 2 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,335 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,335 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,336 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,337 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,337 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,339 - piper_exec - DEBUG - Controller set event for thread 3 stage 3: waiting for thread to grab lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,339 - piper_backend - DEBUG - Thread 3 global rank 1 running stage 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,339 - piper_backend - DEBUG - Thread 3 global rank 1 waiting for actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,339 - piper_backend - DEBUG - Thread 3 global rank 1 got actor mutex 1
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,340 - piper_exec - DEBUG - Controller: thread 3 grabbed lock
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,341 - piper_exec - DEBUG - Controller waiting for thread 3 to join
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,342 - piper_exec - DEBUG - Controller thread 3 joined
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,342 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,343 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 3 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,344 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,344 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,346 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,346 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,348 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,348 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 2 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,350 - piper_exec - DEBUG - Controller waiting for actor 1 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,350 - piper_exec - DEBUG - Controller got actor 1 mutex, launching backward stage 1 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,351 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,351 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 2
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,352 - piper_exec - DEBUG - Controller updating stage 1 mb 0
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,353 - piper_exec - DEBUG - Controller waiting for actor 0 mutex
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,353 - piper_exec - DEBUG - Controller got actor 0 mutex, launching backward stage 0 mb 3
[36m(run_dp_rank pid=1621463)[0m 2026-01-15 01:11:19,354 - piper_exec - DEBUG - Controller updating stage 0 mb 0
[36m(run_dp_rank pid=1621463)[0m Iteration time: 363 ms
[36m(run_dp_rank pid=1621463)[0m interleaved-1f1b throughput: 45079 tokens/sec
Traceback (most recent call last):
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/test/test_llama.py", line 274, in <module>
    ray.get(piper_coordinator.run_program.remote(main, args))
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py", line 2967, in get
    values, debugger_breakpoint = worker.get_objects(
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py", line 1015, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(FileNotFoundError): [36mray::PiperProgramCoordinator.run_program()[39m (pid=1621474, ip=10.158.48.71, actor_id=e335cc59e2ac8c2a6f3a7bd301000000, repr=<src.piper_coordinator.PiperProgramCoordinator object at 0x7fcbaf6eaec0>)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_coordinator.py", line 41, in run_program
    ret = ray.get([run_dp_rank.remote(
ray.exceptions.RayTaskError(FileNotFoundError): [36mray::run_dp_rank()[39m (pid=1621463, ip=10.158.48.71)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_coordinator.py", line 21, in run_dp_rank
    return training_func(*args, **kwargs)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/test/test_llama.py", line 263, in main
    ray.timeline(
FileNotFoundError: [Errno 2] No such file or directory: 'out/LLAMA_DEBUG-pp2-dp1-interleaved-1f1b.json'
[36m(pid=1628883)[0m [2026-01-15 01:11:14,861 E 1628883 1635675] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14[32m [repeated 255x across cluster][0m
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:19,419 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0 global rank 0[32m [repeated 47x across cluster][0m
[36m(PiperActor pid=1621483)[0m 2026-01-15 01:11:19,388 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1 global rank 1[32m [repeated 37x across cluster][0m
[36m(PiperActor pid=1621450)[0m 2026-01-15 01:11:19,426 - piper_actor - DEBUG - Calling update on actor 0 global rank 0[32m [repeated 5x across cluster][0m
