2026-02-18 23:03:36,994	INFO worker.py:2007 -- Started a local Ray instance.
/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(run_dp_rank pid=1051295)[0m 2026-02-18 23:03:51,344 - piper_coordinator - DEBUG - Running DP rank 1 of 1
[36m(run_dp_rank pid=1051295)[0m 2026-02-18 23:03:51,367 - piper_compile - DEBUG - mbs: 4, stages: 4, devices: 2
[36m(run_dp_rank pid=1051295)[0m 2026-02-18 23:03:51,368 - piper_compile - DEBUG - Fwd/bwd schedule: [[Task(pp_rank=0, stage_id=0, mb_idx=0, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=1, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=0, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=1, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=2, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=3, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=0, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=1, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=2, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=0, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=3, is_fwd=True, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=1, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=2, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=2, mb_idx=3, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=2, is_fwd=False, upd=False), Task(pp_rank=0, stage_id=0, mb_idx=3, is_fwd=False, upd=False)], [Task(pp_rank=1, stage_id=1, mb_idx=0, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=1, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=0, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=0, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=1, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=1, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=2, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=0, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=3, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=1, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=2, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=2, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=3, is_fwd=True, upd=False), Task(pp_rank=1, stage_id=3, mb_idx=3, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=2, is_fwd=False, upd=False), Task(pp_rank=1, stage_id=1, mb_idx=3, is_fwd=False, upd=False)]]
[36m(run_dp_rank pid=1051295)[0m 2026-02-18 23:03:51,368 - piper_compile - DEBUG - P2P comms: [(0, 1, 0), (0, 1, 1), (1, 2, 0), (2, 3, 0), (1, 2, 1), (2, 3, 1), (0, 1, 2), (3, 2, 0), (0, 1, 3), (2, 1, 0), (3, 2, 1), (2, 1, 1), (1, 2, 2), (2, 3, 2), (1, 0, 0), (1, 2, 3), (2, 3, 3), (1, 0, 1), (3, 2, 2), (2, 1, 2), (3, 2, 3), (2, 1, 3), (1, 0, 2), (1, 0, 3)]
[36m(run_dp_rank pid=1051295)[0m 2026-02-18 23:03:51,368 - piper_compile - DEBUG - P2P schedules: {0: [(0, 1, 0, True), (0, 1, 1, True), (1, 2, 0, False), (2, 3, 0, True), (1, 2, 1, False), (2, 3, 1, True), (0, 1, 2, True), (3, 2, 0, False), (0, 1, 3, True), (2, 1, 0, True), (3, 2, 1, False), (2, 1, 1, True), (1, 2, 2, False), (2, 3, 2, True), (1, 0, 0, False), (1, 2, 3, False), (2, 3, 3, True), (1, 0, 1, False), (3, 2, 2, False), (2, 1, 2, True), (3, 2, 3, False), (2, 1, 3, True), (1, 0, 2, False), (1, 0, 3, False)], 1: [(0, 1, 0, False), (0, 1, 1, False), (1, 2, 0, True), (2, 3, 0, False), (1, 2, 1, True), (2, 3, 1, False), (0, 1, 2, False), (3, 2, 0, True), (0, 1, 3, False), (2, 1, 0, False), (3, 2, 1, True), (2, 1, 1, False), (1, 2, 2, True), (2, 3, 2, False), (1, 0, 0, True), (1, 2, 3, True), (2, 3, 3, False), (1, 0, 1, True), (3, 2, 2, True), (2, 1, 2, False), (3, 2, 3, True), (2, 1, 3, False), (1, 0, 2, True), (1, 0, 3, True)]}
[36m(run_dp_rank pid=1051295)[0m Namespace(model='debug', schedule='interleaved-1f1b', dp=1, pp=2, batch_size=16, mbs=4, seq_len=256, warmup=5, iters=10, tracing=False, naive_gradient_sync=False)
[36m(run_dp_rank pid=1051295)[0m Schedule:
[36m(run_dp_rank pid=1051295)[0m 0:0:f	0:1:f	2:0:f	2:1:f	0:2:f	0:3:f	2:0:b	 -- 	2:1:b	2:2:f	0:0:b	2:3:f	0:1:b	 -- 	2:2:b	2:3:b	0:2:b	0:3:b	0:0:u	
[36m(run_dp_rank pid=1051295)[0m  -- 	1:0:f	1:1:f	3:0:f	3:0:b	3:1:f	3:1:b	1:2:f	1:0:b	1:3:f	1:1:b	3:2:f	3:2:b	3:3:f	3:3:b	1:2:b	1:3:b	1:0:u	 -- 	
[36m(run_dp_rank pid=1051295)[0m 2026-02-18 23:03:51,434 - piper_actor - DEBUG - DP rank 0 created actor Actor(PiperActor, 35b7629b787175335082b6d901000000) global rank 0
[36m(run_dp_rank pid=1051295)[0m 2026-02-18 23:03:51,435 - piper_actor - DEBUG - DP rank 0 created actor Actor(PiperActor, 22db841fd471dd96fed9c10e01000000) global rank 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:03:54,502 - piper_actor - INFO - Initializing Ray actor 1 global rank 1 GPU 5
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:03:54,542 - piper_actor - INFO - Initializing Ray actor 0 global rank 0 GPU 4
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:03:57,056 - piper_actor - DEBUG - Actor 1 has GPU 5, joined the global process group
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:03:57,056 - piper_actor - INFO - Global rank 1 joined its pp group 0 along with ranks [0, 1]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:03:57,061 - piper_actor - DEBUG - Actor 0 has GPU 4, joined the global process group
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:03:57,061 - piper_actor - INFO - Global rank 0 joined its pp group 0 along with ranks [0, 1]
[36m(run_dp_rank pid=1051295)[0m 2026-02-18 23:03:57,281 - piper_compile - INFO - DP rank 1 compiling...
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:00,872 - piper_actor - INFO - Loading stage 1 graph on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:00,764 - piper_actor - INFO - Loading stage 0 graph on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:02,600 - piper_actor - INFO - Loading stage 2 graph on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:02,633 - piper_actor - INFO - Loading stage 3 graph on actor 1
[36m(run_dp_rank pid=1051295)[0m 2026-02-18 23:04:02,770 - piper_backend - WARNING - Should not directly call compiled module, running non-distributed execution
[36m(run_dp_rank pid=1051295)[0m 2026-02-18 23:04:09,209 - piper_compile - INFO - DP rank 1 done.
[36m(run_dp_rank pid=1051295)[0m Running 5 warmup iterations...
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:09,249 - piper_actor - DEBUG - Actor 1 loaded labels torch.Size([16, 256, 512])
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:09,254 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:09,254 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m [rank1]:[W218 23:04:09.736660570 ProcessGroupNCCL.cpp:4068] Warning: An unbatched P2P op (send/recv) was called on this ProcessGroup with size 2.  In lazy initialization mode, this will result in a new 2-rank NCCL communicator to be created. (function operator())
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:09,236 - piper_actor - DEBUG - Actor 0 loaded inputs 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:09,254 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:09,896 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:09,896 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m [rank0]:[W218 23:04:09.378183418 ProcessGroupNCCL.cpp:4068] Warning: An unbatched P2P op (send/recv) was called on this ProcessGroup with size 2.  In lazy initialization mode, this will result in a new 2-rank NCCL communicator to be created. (function operator())
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:19,399 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:19,400 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:19,400 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,389 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,390 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,390 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,391 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,399 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,399 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,400 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,400 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,400 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,401 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:19,401 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m [rank0]:[W218 23:04:19.883031967 ProcessGroupNCCL.cpp:4068] Warning: An unbatched P2P op (send/recv) was called on this ProcessGroup with size 2.  In lazy initialization mode, this will result in a new 2-rank NCCL communicator to be created. (function operator())
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:19,647 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:19,647 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:19,648 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:19,648 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:19,648 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m [rank1]:[W218 23:04:19.130470431 ProcessGroupNCCL.cpp:4068] Warning: An unbatched P2P op (send/recv) was called on this ProcessGroup with size 2.  In lazy initialization mode, this will result in a new 2-rank NCCL communicator to be created. (function operator())
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,801 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,802 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,802 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,806 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,806 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,821 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,821 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,822 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,822 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,822 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,822 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,822 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,822 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,823 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,823 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,840 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,840 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,842 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,800 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,801 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,801 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,811 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,812 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,812 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,812 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,812 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,814 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,814 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,814 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,814 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,814 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,822 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,823 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,823 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,823 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,823 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,824 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,835 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,835 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,836 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,836 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,836 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,836 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,845 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,846 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,846 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,921 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,922 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,922 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,922 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,923 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,923 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,923 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,923 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,923 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,924 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,924 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,927 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,927 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,928 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,934 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,935 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,935 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,935 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,935 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,942 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,942 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,942 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,942 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,962 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,962 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,964 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,964 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,965 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,969 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,969 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,970 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,970 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,970 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,971 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,972 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,972 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,972 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,972 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,972 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,972 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,973 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,973 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,975 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,975 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,975 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,975 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,975 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,976 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,977 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,977 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,977 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,977 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,977 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:27,977 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,024 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,024 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,028 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,028 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,029 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,039 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,039 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,039 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,040 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,040 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,044 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,044 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,045 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,050 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,051 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,055 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,055 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,056 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,056 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,057 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,057 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,057 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m /m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/torch/autograd/graph.py:865: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:330.)
[36m(PiperActor pid=1051350)[0m   return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,959 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,959 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,959 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,959 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,960 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,961 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,961 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,961 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,961 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,962 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,962 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,962 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,966 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,966 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,967 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,967 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,968 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,968 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,968 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,968 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,968 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,971 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,971 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,971 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,971 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,971 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,972 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,972 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:27,973 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,018 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,019 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,020 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,020 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,020 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,020 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,023 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,023 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,023 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,023 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,023 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,024 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,024 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,024 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,029 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,030 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,030 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,030 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,035 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,035 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,035 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,035 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,040 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,040 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,040 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,044 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,044 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,045 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,045 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,056 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,056 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,057 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,061 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,062 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,062 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,062 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,063 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,063 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,063 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,063 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,064 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,064 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,061 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,064 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,064 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,065 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,069 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,070 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,070 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,661 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,661 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,662 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,662 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,662 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,666 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,666 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,667 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,667 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,667 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,668 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,668 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,668 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,669 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,669 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,672 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,672 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,672 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,672 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,672 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,673 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,673 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,673 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,673 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,673 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,676 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,676 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,677 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,684 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,684 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,684 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,684 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,685 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,685 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,685 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,685 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,685 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,686 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,686 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,688 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,688 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,690 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,695 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,696 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,696 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,696 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,696 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,661 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,664 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,664 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,665 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,665 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,665 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,665 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,668 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,668 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,668 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,668 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,668 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,669 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,669 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,669 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,669 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,670 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,672 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,672 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,672 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,672 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,672 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,673 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,673 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,673 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,673 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,674 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,676 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,676 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,676 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,676 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,676 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,677 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,679 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,680 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,680 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,680 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,680 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,681 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,683 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,683 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,683 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,689 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,689 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,690 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,690 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,690 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,690 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,691 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,691 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,691 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,691 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,692 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,692 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,696 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,696 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,697 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,697 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,700 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,700 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,701 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,701 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,702 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,702 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,705 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,705 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,706 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,710 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,710 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,710 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,710 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,710 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,711 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,711 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,712 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,712 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,712 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,712 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,712 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,712 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,713 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,715 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,715 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,715 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,715 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,715 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,717 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,717 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,718 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,718 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,718 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,718 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,718 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,721 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,721 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,724 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,725 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,726 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,732 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,732 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,732 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,733 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,733 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,736 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,736 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,737 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,701 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,701 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,702 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,702 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,702 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,704 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,704 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,705 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,705 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,705 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,711 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,711 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,711 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,716 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,717 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,717 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,717 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,718 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,718 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,720 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,720 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,720 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,721 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,721 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,721 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,721 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,722 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,726 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,727 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,727 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,728 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,732 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,732 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,732 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,732 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,735 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,735 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,735 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,739 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,739 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,740 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,740 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,743 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,743 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,748 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,748 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,748 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,749 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,749 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,749 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,750 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,754 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,754 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,754 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,754 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,755 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,755 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,755 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,756 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,756 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,756 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,777 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,777 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,777 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,777 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,777 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,780 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,780 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,781 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,781 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,781 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,749 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,749 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,749 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,754 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,757 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,757 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,757 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,761 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,763 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,763 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,776 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,779 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,779 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,780 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,780 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,780 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,780 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,781 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,781 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,781 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,784 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,784 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,786 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,788 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,788 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,790 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,791 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,792 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,798 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,798 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,798 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,799 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,799 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,799 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,799 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,799 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,799 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,800 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,800 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,802 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,803 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,804 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,809 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,810 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,810 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,810 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,810 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,815 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,815 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,815 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,815 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,816 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,816 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,818 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,783 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,783 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,783 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,784 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,784 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,784 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,784 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,784 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,785 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,785 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,787 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,788 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,788 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,788 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,789 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,789 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,791 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,791 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,791 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,791 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,791 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,792 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,794 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,795 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,795 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,795 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,795 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,796 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,798 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,798 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,799 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,803 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,803 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,804 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,804 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,804 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,804 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,804 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,805 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,805 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,805 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,805 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,806 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,810 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,810 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,810 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,810 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,815 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,816 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,816 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,816 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,816 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,818 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,818 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,819 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,819 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,819 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,819 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,819 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,823 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,824 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,824 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,824 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,824 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,825 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,825 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,825 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,825 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,825 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,825 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,825 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,826 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,826 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,829 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,829 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,829 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,829 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,829 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,830 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,830 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,830 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,830 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,830 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,831 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,831 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,834 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,834 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,837 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,837 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,838 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,844 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,844 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,845 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,845 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,845 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,847 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,848 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,849 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,855 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,855 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,824 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,825 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,825 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,829 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,830 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,830 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,831 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,831 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,831 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,833 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,833 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,834 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,834 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,834 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,835 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,835 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,835 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,839 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,841 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,841 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,841 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,845 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,845 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,846 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,846 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,848 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,848 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,848 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,852 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,852 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,852 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,852 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,860 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,860 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,860 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,860 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,861 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,861 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,861 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,866 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,866 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,866 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,866 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,867 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,867 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,867 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,867 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,868 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,868 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,880 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,880 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,880 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,880 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,880 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,883 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,884 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,884 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,884 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,884 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,884 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,885 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,885 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,887 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,887 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,890 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,890 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,892 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,892 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,894 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,894 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,895 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,861 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,861 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,861 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,866 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,868 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,869 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,869 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,873 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,874 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,874 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,879 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,882 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,882 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,883 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,883 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,883 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,884 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,886 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,886 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,886 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,887 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,887 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,887 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,887 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,887 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,888 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,888 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,890 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,890 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,890 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,891 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,892 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,892 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,894 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,894 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,894 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,894 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,894 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,895 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,897 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,902 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,902 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,902 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,902 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,902 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,902 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,903 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,903 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,903 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,903 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,903 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,906 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,906 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,907 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,913 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,914 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,914 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,914 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,914 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,918 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,919 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,919 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,919 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,919 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,920 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,922 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,922 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,923 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,927 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,927 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,928 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,928 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,928 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,928 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,929 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,929 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,929 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,929 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,929 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,929 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,930 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,930 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,932 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,932 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,933 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,933 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,933 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,933 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,933 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,934 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,934 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,934 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,934 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,934 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,898 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,898 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,898 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,898 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,899 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,901 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,901 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,901 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,906 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,906 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,906 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,907 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,907 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,908 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,908 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,908 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,908 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,908 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,909 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,909 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,913 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,913 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,913 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,913 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,919 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,919 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,920 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,920 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,920 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,922 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,922 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,923 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,923 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,923 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,928 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,928 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,929 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,933 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,934 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,934 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,935 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,935 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,935 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,937 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,937 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,937 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,938 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,938 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,938 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,940 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,941 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,942 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,948 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,948 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,948 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,949 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,949 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,951 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,952 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,953 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,958 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,959 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,964 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,964 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,964 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,964 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,965 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,965 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,965 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,970 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,970 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,970 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,970 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,971 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,971 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,971 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,971 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,971 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,971 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,938 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,938 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,939 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,939 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,943 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,944 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,945 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,945 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,949 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,949 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,949 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,949 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,951 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,952 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,952 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,956 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,956 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,956 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,956 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,965 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,965 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,965 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,969 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,972 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,973 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,973 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,984 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,984 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,984 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,984 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,984 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,987 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,987 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,987 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,988 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,988 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,988 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,988 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,988 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,991 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,991 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,993 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,995 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,995 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,997 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,998 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:28,999 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,005 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,005 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,005 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,005 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,006 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,006 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,006 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,006 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,006 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,006 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,007 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,009 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,009 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,010 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,977 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,978 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,978 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,983 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,986 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,986 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,987 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,987 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,987 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,987 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,990 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,990 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,991 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,991 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,991 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,991 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,991 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,992 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,992 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,992 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,994 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,995 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,995 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,995 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,996 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,996 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,996 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,998 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,998 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,998 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,998 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,998 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:28,999 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,001 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,002 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,002 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,002 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,002 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,003 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,005 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,005 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,006 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,010 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,010 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,010 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,010 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,010 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,011 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,011 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,012 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,012 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,012 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,012 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,013 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,016 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,017 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,017 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,017 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,017 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,022 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,022 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,022 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,022 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,023 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,023 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,025 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,025 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,026 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,030 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,030 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,031 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,031 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,031 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,031 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,031 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,032 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,032 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,032 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,032 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,032 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,032 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,033 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,035 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,035 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,035 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,036 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,036 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,036 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,036 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,037 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,037 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,037 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,037 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,037 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,041 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,041 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,043 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,043 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,045 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,051 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,051 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,051 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,052 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,052 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,017 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,017 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,017 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,017 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,022 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,022 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,023 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,023 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,023 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,025 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,025 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,026 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,026 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,026 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,031 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,031 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,032 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,036 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,037 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,037 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,037 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,038 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,038 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,040 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,040 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,040 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,040 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,041 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,041 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,041 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,042 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,046 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,047 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,047 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,048 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,052 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,052 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,052 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,052 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,054 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,054 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,055 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(run_dp_rank pid=1051295)[0m Running 10 timed iterations...
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,054 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,054 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,056 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,061 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,062 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,066 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,066 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,066 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,067 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,067 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,067 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,068 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,072 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,072 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,072 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,073 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,073 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,073 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,074 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,074 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,074 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,074 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,085 - piper_actor - INFO - Actor 1: Tracing disabled
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,087 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,087 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,088 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,088 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,088 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,090 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,091 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,091 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,091 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,091 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,092 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,092 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,092 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,059 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,059 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,059 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,059 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,067 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,067 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,067 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,072 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,075 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,075 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,075 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,079 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,081 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,081 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,085 - piper_actor - INFO - Actor 0: Tracing disabled
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,087 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,090 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,090 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,091 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,091 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,091 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,091 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,093 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,095 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,095 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,097 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,097 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,098 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,098 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,098 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,098 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,098 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,098 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,099 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,099 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,101 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,102 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,102 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,109 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,109 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,109 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,109 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,109 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,110 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,110 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,110 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,110 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,110 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,110 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,113 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,113 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,114 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,120 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,121 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,121 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,121 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,121 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,125 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,125 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,126 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,126 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,126 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,127 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,129 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,129 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,130 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,094 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,094 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,094 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,094 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,095 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,095 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,095 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,095 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,095 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,097 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,098 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,098 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,098 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,098 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,099 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,099 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,099 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,099 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,099 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,101 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,102 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,102 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,102 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,102 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,103 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,105 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,105 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,105 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,106 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,106 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,106 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,109 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,109 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,109 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,113 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,113 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,114 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,114 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,114 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,115 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,115 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,115 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,115 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,116 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,116 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,116 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,120 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,120 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,121 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,121 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,126 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,126 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,126 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,127 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,127 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,129 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,129 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,129 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,130 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,130 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,134 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,134 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,135 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,135 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,135 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,135 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,135 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,136 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,136 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,136 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,136 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,136 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,136 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,137 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,139 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,139 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,139 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,140 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,140 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,140 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,140 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,141 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,141 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,141 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,141 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,141 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,145 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,145 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,147 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,148 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,149 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,155 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,155 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,155 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,156 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,156 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,158 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,159 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,160 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,165 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,166 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,135 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,135 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,136 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,140 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,141 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,141 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,141 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,142 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,142 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,144 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,144 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,144 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,145 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,145 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,145 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,145 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,146 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,150 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,151 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,151 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,152 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,156 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,156 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,156 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,156 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,158 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,158 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,159 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,162 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,163 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,163 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,163 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,170 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,170 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,171 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,171 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,171 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,172 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,172 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,176 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,177 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,177 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,177 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,177 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,178 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,178 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,178 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,178 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,178 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,190 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,190 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,191 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,191 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,191 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,193 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,194 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,194 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,194 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,194 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,194 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,194 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,195 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,198 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,198 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,200 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,200 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,200 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,201 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,201 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,201 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,201 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,201 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,201 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,202 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,204 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,204 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,205 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,171 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,171 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,172 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,176 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,179 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,179 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,180 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,184 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,185 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,185 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,190 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,193 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,193 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,193 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,194 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,194 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,194 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,196 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,197 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,197 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,197 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,197 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,198 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,198 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,198 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,198 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,198 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,200 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,201 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,201 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,201 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,201 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,202 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,202 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,202 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,202 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,202 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,204 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,205 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,205 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,205 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,205 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,206 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,208 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,208 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,208 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,208 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,209 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,209 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,211 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,212 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,212 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,212 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,212 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,212 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,212 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,213 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,213 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,213 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,213 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,216 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,216 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,217 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,223 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,224 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,224 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,224 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,224 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,228 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,228 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,229 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,229 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,229 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,230 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,232 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,232 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,233 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,237 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,237 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,238 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,238 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,238 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,238 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,238 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,239 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,239 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,239 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,239 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,239 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,239 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,240 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,242 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,242 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,243 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,243 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,243 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,243 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,243 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,244 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,244 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,244 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,244 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,244 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,248 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,248 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,211 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,212 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,212 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,216 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,216 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,217 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,217 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,217 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,218 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,218 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,218 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,218 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,219 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,219 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,219 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,223 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,224 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,224 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,224 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,229 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,229 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,229 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,230 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,230 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,232 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,232 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,233 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,233 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,233 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,238 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,238 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,239 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,243 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,244 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,244 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,244 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,245 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,245 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,247 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,247 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,247 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,248 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,248 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,248 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,248 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,249 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,250 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,251 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,252 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,258 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,258 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,258 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,259 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,259 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,261 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,262 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,263 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,269 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,269 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,274 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,274 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,274 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,274 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,275 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,275 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,275 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,280 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,280 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,280 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,280 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,281 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,281 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,281 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,281 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,282 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,282 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,253 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,254 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,254 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,255 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,259 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,259 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,259 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,259 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,261 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,262 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,262 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,266 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,266 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,266 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,266 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,275 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,275 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,275 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,280 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,283 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,283 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,283 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,287 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,294 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,294 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,295 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,295 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,295 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,297 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,298 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,298 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,298 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,298 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,298 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,298 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,298 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,302 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,302 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,304 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,304 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,304 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,305 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,305 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,305 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,305 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,305 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,306 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,306 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,308 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,308 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,309 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,315 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,316 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,316 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,316 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,316 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,316 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,317 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,317 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,317 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,317 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,317 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,320 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,320 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,321 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,288 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,288 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,294 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,297 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,297 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,297 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,298 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,298 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,298 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,300 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,301 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,301 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,301 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,301 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,302 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,302 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,302 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,302 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,302 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,304 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,304 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,305 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,305 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,305 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,306 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,306 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,306 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,306 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,306 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,308 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,308 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,309 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,309 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,309 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,310 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,312 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,312 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,312 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,312 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,312 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,313 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,315 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,315 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,316 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,320 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,320 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,321 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,321 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,321 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,322 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,322 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,322 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,322 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,323 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,323 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,323 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,327 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,327 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,327 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,328 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,327 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,327 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,328 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,328 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,328 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,332 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,332 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,333 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,333 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,333 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,333 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,336 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,336 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,337 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,341 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,341 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,341 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,341 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,342 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,342 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,342 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,342 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,343 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,343 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,343 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,343 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,343 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,343 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,346 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,346 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,346 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,346 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,346 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,347 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,347 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,347 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,347 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,347 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,348 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,348 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,352 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,352 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,354 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,354 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,356 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,362 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,362 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,362 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,363 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,363 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,365 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,365 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,366 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,333 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,333 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,333 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,334 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,334 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,336 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,336 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,336 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,336 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,337 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,342 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,342 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,342 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,347 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,348 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,348 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,348 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,348 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,348 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,351 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,351 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,351 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,351 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,351 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,352 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,352 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,352 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,357 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,358 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,358 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,358 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,363 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,363 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,363 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,363 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,365 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,365 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,365 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,372 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,373 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,377 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,377 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,377 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,378 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,378 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,379 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,379 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,383 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,383 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,384 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,384 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,384 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,385 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,385 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,385 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,385 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,385 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,397 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,397 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,398 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,398 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,398 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,400 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,401 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,401 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,401 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,401 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,401 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,402 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,402 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,404 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,404 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,369 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,370 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,370 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,370 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,378 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,378 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,378 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,383 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,386 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,386 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,386 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,391 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,392 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,392 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,397 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,400 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,400 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,400 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,400 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,400 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,401 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,403 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,403 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,404 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,404 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,404 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,405 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,405 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,405 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,405 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,405 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,407 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,407 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,407 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,407 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,407 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,408 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,408 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,408 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,408 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,408 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,411 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,411 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,412 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,418 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,419 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,419 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,419 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,419 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,419 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,419 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,419 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,419 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,420 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,420 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,423 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,423 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,424 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,430 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,431 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,431 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,431 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,431 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,436 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,436 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,436 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,436 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,437 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,437 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,439 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,439 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,440 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,407 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,407 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,408 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,408 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,408 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,408 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,409 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,409 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,409 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,409 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,411 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,411 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,411 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,412 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,412 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,412 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,415 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,415 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,415 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,415 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,415 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,416 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,418 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,418 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,419 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,423 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,423 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,423 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,423 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,424 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,425 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,425 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,425 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,425 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,425 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,426 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,426 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,430 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,430 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,430 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,430 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,436 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,437 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,437 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,437 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,437 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,439 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,440 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,440 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,440 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,440 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,444 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,445 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,445 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,445 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,445 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,446 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,446 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,446 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,446 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,446 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,446 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,446 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,447 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,447 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,449 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,449 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,450 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,450 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,450 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,450 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,451 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,451 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,451 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,451 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,451 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,451 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,455 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,455 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,457 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,458 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,459 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,465 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,465 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,465 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,466 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,466 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,469 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,469 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,470 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,476 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,476 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,480 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,481 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,481 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,481 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,482 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,482 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,482 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,445 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,445 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,446 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,450 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,451 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,451 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,452 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,452 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,452 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,454 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,454 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,455 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,455 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,455 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,455 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,456 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,456 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,460 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,461 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,462 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,462 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,466 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,466 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,466 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,466 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,468 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,469 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,469 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,473 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,473 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,473 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,473 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,481 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,481 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,482 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,487 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,487 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,487 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,487 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,488 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,488 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,488 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,488 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,488 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,488 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,500 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,500 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,501 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,501 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,501 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,503 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,504 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,504 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,504 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,504 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,504 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,505 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,505 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,507 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,508 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,510 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,510 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,510 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,510 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,510 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,511 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,511 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,511 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,511 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,511 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,514 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,514 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,515 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,521 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,522 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,522 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,522 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,522 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,522 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,522 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,522 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,522 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,523 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,523 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,486 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,489 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,489 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,490 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,494 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,495 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,495 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,500 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,503 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,503 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,503 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,503 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,504 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,504 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,506 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,506 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,507 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,507 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,507 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,508 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,508 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,508 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,508 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,508 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,510 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,510 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,511 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,511 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,511 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,512 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,512 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,512 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,512 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,512 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,514 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,514 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,515 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,515 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,515 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,515 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,518 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,518 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,518 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,518 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,518 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,519 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,521 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,521 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,522 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,525 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,526 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,527 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,533 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,533 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,533 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,533 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,533 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,538 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,538 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,538 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,538 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,539 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,539 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,541 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,542 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,542 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,547 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,547 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,547 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,547 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,547 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,548 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,548 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,548 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,548 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,548 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,548 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,548 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,549 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,549 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,551 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,551 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,552 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,552 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,552 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,553 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,553 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,553 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,553 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,553 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,553 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,553 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,557 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,557 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,560 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,560 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,561 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,526 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,526 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,526 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,526 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,526 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,528 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,528 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,528 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,528 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,528 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,529 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,529 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,533 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,533 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,533 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,533 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,539 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,539 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,539 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,539 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,539 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,541 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,541 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,542 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,542 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,542 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,547 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,548 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,548 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,552 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,553 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,553 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,554 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,554 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,554 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,556 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,556 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,557 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,557 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,557 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,558 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,558 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,558 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,563 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,563 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,568 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,568 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,569 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,569 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,569 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,572 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,572 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,573 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,579 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,579 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,584 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,584 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,584 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,584 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,585 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,585 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,585 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,590 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,590 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,590 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,590 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,591 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,591 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,591 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,591 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,592 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,592 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,564 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,564 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,568 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,568 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,568 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,568 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,571 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,571 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,571 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,575 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,575 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,575 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,576 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,585 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,585 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,585 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,590 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,593 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,593 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,593 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,597 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,598 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,598 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,604 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,604 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,605 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,605 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,605 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,607 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,607 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,608 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,608 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,608 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,608 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,608 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,608 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,611 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,611 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,613 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,614 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,614 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,614 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,614 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,614 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,614 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,614 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,615 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,615 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,617 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,618 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,619 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,625 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,625 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,626 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,626 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,626 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,626 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,626 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,626 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,626 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,627 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,627 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,629 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,630 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,631 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,637 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,637 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,637 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,637 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,637 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,642 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,642 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,642 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,642 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,604 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,606 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,607 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,607 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,607 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,607 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,608 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,610 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,610 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,611 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,611 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,611 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,611 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,611 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,612 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,612 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,612 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,614 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,614 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,614 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,615 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,615 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,615 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,615 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,616 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,616 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,616 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,618 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,618 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,618 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,618 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,618 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,619 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,621 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,622 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,622 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,622 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,622 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,623 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,625 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,625 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,625 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,630 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,630 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,630 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,630 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,630 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,631 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,631 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,632 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,632 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,632 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,632 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,633 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,638 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,638 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,638 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,638 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,643 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,643 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,643 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,643 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,643 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,643 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,643 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,645 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,646 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,646 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,651 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,652 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,652 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,652 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,652 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,653 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,653 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,653 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,653 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,653 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,653 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,653 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,654 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,654 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,656 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,656 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,657 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,657 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,657 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,658 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,658 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,658 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,658 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,658 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,658 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,658 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,663 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,663 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,666 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,666 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,667 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,673 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,673 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,673 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,674 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,674 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,677 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,677 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,678 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,645 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,646 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,646 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,646 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,646 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,653 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,653 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,653 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,659 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,659 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,659 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,659 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,660 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,660 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,662 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,662 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,663 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,663 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,663 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,663 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,663 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,664 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,669 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,670 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,670 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,670 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,675 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,675 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,675 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,675 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,677 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,677 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,677 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,684 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,684 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,689 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,689 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,689 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,689 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,690 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,690 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,690 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,695 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,695 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,695 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,695 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,696 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,696 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,696 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,696 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,697 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,697 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,711 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,712 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,712 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,712 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,712 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,715 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,715 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,715 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,715 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,716 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,716 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,716 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,716 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,719 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,719 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,682 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,682 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,682 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,682 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,690 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,690 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,690 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,696 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,698 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,698 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,698 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,703 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,704 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,704 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,711 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,714 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,715 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,715 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,715 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,715 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,716 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,718 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,718 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,719 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,719 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,719 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,719 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,719 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,720 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,720 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,720 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,722 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,722 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,722 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,722 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,722 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,723 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,723 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,723 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,723 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,723 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,725 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,726 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,727 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,733 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,734 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,734 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,734 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,734 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,734 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,734 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,734 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,734 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,735 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,735 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,737 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,738 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,739 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,745 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,745 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,745 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,745 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,745 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,750 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,750 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,750 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,751 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,751 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,751 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,754 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,754 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,754 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,759 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,759 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,759 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,759 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,760 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,722 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,722 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,722 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,723 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,723 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,723 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,723 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,724 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,724 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,724 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,726 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,726 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,726 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,726 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,726 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,727 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,729 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,730 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,730 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,730 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,730 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,731 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,733 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,733 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,733 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,739 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,739 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,739 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,739 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,739 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,740 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,740 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,740 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,740 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,741 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,741 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,741 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,746 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,746 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,746 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,746 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,751 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,751 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,751 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,751 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,751 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,754 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,754 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,754 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,755 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,755 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,760 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,760 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,760 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,760 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,760 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,760 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,761 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,761 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,761 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,761 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,761 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,761 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,764 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,764 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,764 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,765 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,765 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,765 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,765 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,765 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,766 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,766 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,766 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,766 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,770 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,770 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,773 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,773 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,774 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,780 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,781 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,781 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,781 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,781 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,784 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,784 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,785 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,791 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,792 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,796 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,797 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,797 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,797 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,798 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,798 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,798 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,765 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,766 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,766 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,766 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,766 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,766 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,769 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,769 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,769 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,770 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,770 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,770 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,770 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,771 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,775 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,776 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,776 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,777 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,781 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,781 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,781 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,782 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,783 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,784 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,784 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,788 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,788 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,789 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,789 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,797 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,798 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,798 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,802 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,803 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,803 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,803 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,804 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,804 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,804 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,804 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,804 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,804 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,817 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,817 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,817 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,817 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,817 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,820 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,820 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,820 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,821 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,821 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,821 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,821 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,821 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,824 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,824 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,826 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,827 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,827 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,827 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,827 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,827 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,827 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,827 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,828 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,828 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,830 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,831 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,832 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,803 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,805 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,805 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,806 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,810 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,811 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,811 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,817 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,819 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,820 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,820 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,820 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,820 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,821 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,823 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,823 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,824 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,824 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,824 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,824 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,824 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,825 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,825 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,825 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,827 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,827 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,828 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,828 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,828 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,828 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,828 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,829 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,829 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,829 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,831 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,831 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,831 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,831 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,832 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,832 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,834 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,835 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,835 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,835 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,835 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,836 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,838 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,838 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,838 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,838 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,839 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,839 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,839 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,839 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,839 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,839 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,839 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,839 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,840 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,840 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,842 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,843 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,844 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,849 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,850 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,850 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,850 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,850 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,855 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,855 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,855 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,855 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,856 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,856 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,858 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,859 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,859 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,863 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,864 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,864 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,864 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,864 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,865 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,865 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,865 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,865 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,865 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,865 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,865 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,866 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,866 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,868 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,869 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,869 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,869 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,869 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,870 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,870 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,870 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,870 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,870 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,870 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,870 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,874 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,875 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,843 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,844 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,844 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,844 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,844 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,845 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,845 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,845 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,845 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,846 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,846 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,846 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,850 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,851 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,851 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,851 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,855 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,856 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,856 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,856 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,856 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,858 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,859 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,859 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,859 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,859 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,865 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,865 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,865 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,870 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,870 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,871 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,871 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,871 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,871 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,873 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,874 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,874 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,874 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,874 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,875 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,875 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,875 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,877 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,877 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,878 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,884 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,885 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,885 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,885 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,885 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,889 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,889 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,890 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,896 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,896 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,901 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,901 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,901 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,901 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,902 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,902 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,902 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,907 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,907 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,907 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,907 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,908 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,908 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,908 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,908 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,909 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,909 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,880 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,881 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,881 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,881 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,885 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,886 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,886 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,886 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,888 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,888 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,888 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,892 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,892 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,893 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,893 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,902 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,902 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,902 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,907 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,910 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,910 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,910 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,915 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,916 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,916 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,921 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,921 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,922 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,922 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,922 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,924 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,929 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,929 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,931 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,931 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,932 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,932 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,932 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,932 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,932 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,932 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,933 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,933 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,935 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,935 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,936 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,943 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,944 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,944 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,944 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,944 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,944 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,944 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,944 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,944 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,945 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,945 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,947 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,948 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,949 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,955 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,955 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,955 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,955 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,955 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,921 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,924 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,924 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,925 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,928 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,928 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,928 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,928 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,928 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,929 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,929 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,929 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,929 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,929 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,931 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,932 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,932 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,932 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,932 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,933 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,933 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,933 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,933 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,933 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,935 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,936 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,936 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,936 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,936 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,937 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,939 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,939 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,940 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,940 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,940 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,940 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,942 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,943 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,943 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,948 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,949 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,949 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,949 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,949 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,950 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,950 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,950 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,950 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,951 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,951 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,951 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,955 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,956 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,956 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,956 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,960 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,960 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,960 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,960 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,961 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,961 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,963 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,964 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,964 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,969 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,969 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,969 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,969 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,970 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,970 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,970 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,970 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,970 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,971 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,971 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,971 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,971 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,971 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,974 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,974 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,974 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,974 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,974 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,975 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,975 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,975 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,975 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,975 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,976 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,976 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,980 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,981 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,983 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,983 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,984 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,990 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,991 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,991 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,991 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,992 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,994 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,994 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:29,995 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,961 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,961 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,961 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,961 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,961 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,964 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,964 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,964 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,964 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,964 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,970 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,970 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,970 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,976 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,976 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,977 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,977 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,977 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,977 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,979 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,980 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,980 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,980 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,980 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,981 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,981 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,981 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,986 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,987 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,987 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,987 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,992 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,992 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,992 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,992 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,994 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,994 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,994 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,001 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,002 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,006 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,006 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,007 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,007 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,007 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,008 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,008 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,012 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,012 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,013 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,013 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,013 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,013 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,014 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,014 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,014 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,014 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,026 - piper_actor - DEBUG - Calling forward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,027 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,027 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,027 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,027 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,029 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,030 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,030 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,030 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,030 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,031 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,031 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,031 - piper_actor - DEBUG - Forward 1 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,034 - piper_actor - DEBUG - Calling forward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,034 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,036 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,036 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,999 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,999 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,999 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:29,999 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,007 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,007 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,008 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,013 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,015 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,015 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,015 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,020 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,021 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,021 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,026 - piper_actor - DEBUG - Calling forward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,029 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,029 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,030 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,030 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,030 - piper_actor - DEBUG - Forward 0 mb 0 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,030 - piper_actor - DEBUG - Calling forward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,033 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,033 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,033 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,033 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,034 - piper_actor - DEBUG - Forward 0 mb 1 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,034 - piper_actor - DEBUG - Calling forward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,034 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,034 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,034 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,035 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Forward 2 mb 0 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,037 - piper_actor - DEBUG - Forward 1 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,038 - piper_actor - DEBUG - Calling forward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,038 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,040 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,040 - piper_actor - DEBUG - Forward 3 mb 0 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,042 - piper_actor - DEBUG - Calling backward 3 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,048 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,048 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,048 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,048 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,049 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,049 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,049 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,049 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,049 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,049 - piper_actor - DEBUG - Calling forward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,049 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,052 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,052 - piper_actor - DEBUG - Forward 3 mb 1 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,053 - piper_actor - DEBUG - Calling backward 3 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,059 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,060 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,060 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 0 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,060 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,060 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,064 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,065 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,065 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,065 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,065 - piper_actor - DEBUG - Calling forward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,066 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,068 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,068 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,069 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,073 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,073 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,074 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,074 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,074 - piper_actor - DEBUG - Forward 1 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,074 - piper_actor - DEBUG - Calling backward 1 mb 0 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,074 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,075 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,075 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,075 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,075 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,075 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 0) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,076 - piper_actor - DEBUG - Calling forward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,076 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,038 - piper_actor - DEBUG - Calling forward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,038 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,038 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,038 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,038 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,041 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,041 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,041 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,041 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,041 - piper_actor - DEBUG - Forward 2 mb 1 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,042 - piper_actor - DEBUG - Calling forward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,044 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,044 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,045 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,045 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,045 - piper_actor - DEBUG - Forward 0 mb 2 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,045 - piper_actor - DEBUG - Calling forward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,048 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 0 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,048 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,048 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,053 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,053 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,054 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,054 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 0 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,054 - piper_actor - DEBUG - Forward 0 mb 3 on actor 0 returning [torch.Size([256, 8]), torch.Size([16, 256, 512]), torch.Size([256, 256])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,054 - piper_actor - DEBUG - Calling backward 2 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,054 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,055 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,055 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,055 - piper_actor - DEBUG - Calling backward 2 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,055 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,056 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,060 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,060 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,061 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,061 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,065 - piper_actor - DEBUG - Calling forward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,065 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,066 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,066 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,066 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,068 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 2
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,069 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,069 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,069 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,069 - piper_actor - DEBUG - Forward 2 mb 2 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,074 - piper_actor - DEBUG - Calling backward 0 mb 0 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,074 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,075 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,078 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 1 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,078 - piper_actor - DEBUG - Dispatch fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,079 - piper_actor - DEBUG - Completed fwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,079 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 1 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,079 - piper_actor - DEBUG - Forward 1 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,079 - piper_actor - DEBUG - Calling backward 1 mb 1 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,079 - piper_actor - DEBUG - Dispatch fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,080 - piper_actor - DEBUG - Completed fwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,080 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 2 -> 3, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,080 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,080 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,080 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 1) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,084 - piper_actor - DEBUG - Calling forward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,084 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,087 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 2
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,087 - piper_actor - DEBUG - Forward 3 mb 2 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,088 - piper_actor - DEBUG - Calling backward 3 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,094 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,095 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,095 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,095 - piper_actor - DEBUG - Calling forward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,095 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,098 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 3 mb 3
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,098 - piper_actor - DEBUG - Forward 3 mb 3 on actor 1 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,100 - piper_actor - DEBUG - Calling backward 3 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,107 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,108 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,112 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,112 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,113 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,113 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 3 -> 2, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,113 - piper_actor - DEBUG - Calling backward 1 mb 2 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,114 - piper_actor - DEBUG - Dispatch bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,114 - piper_actor - DEBUG - Completed bwd p2p recv on 1 from 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,080 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 0) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,080 - piper_actor - DEBUG - Calling forward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,080 - piper_actor - DEBUG - Dispatch fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,081 - piper_actor - DEBUG - Completed fwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,081 - piper_actor - DEBUG - Executed P2P(fwd_recv, stage 1 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,081 - piper_actor - DEBUG - Saving input activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,083 - piper_actor - DEBUG - Saving output activation torch.Size([16, 256, 512]) for stage 2 mb 3
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,084 - piper_actor - DEBUG - Dispatch fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,084 - piper_actor - DEBUG - Completed fwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,084 - piper_actor - DEBUG - Executed P2P(fwd_send, stage 2 -> 3, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,084 - piper_actor - DEBUG - Forward 2 mb 3 on actor 0 returning [torch.Size([16, 256, 512])]
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,085 - piper_actor - DEBUG - Calling backward 0 mb 1 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,085 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,085 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,090 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 1) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,091 - piper_actor - DEBUG - Calling backward 2 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,091 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,091 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,096 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,096 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,096 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,096 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,098 - piper_actor - DEBUG - Calling backward 2 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,098 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,098 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,103 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 3 -> 2, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,103 - piper_actor - DEBUG - Dispatch bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,103 - piper_actor - DEBUG - Completed bwd p2p send on 0 to 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,103 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 2 -> 1, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,113 - piper_actor - DEBUG - Calling backward 0 mb 2 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,113 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,114 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(run_dp_rank pid=1051295)[0m rank 0 iter time= 0.10 ± 0.00 s (10 samples)
[36m(run_dp_rank pid=1051295)[0m rank 0 throughput= 156858.18 tokens/sec (10 samples)
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,118 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 2 -> 1, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,118 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,119 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,119 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 2) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,119 - piper_actor - DEBUG - Calling backward 1 mb 3 on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,120 - piper_actor - DEBUG - Dispatch bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,120 - piper_actor - DEBUG - Completed bwd p2p send on 1 to 0
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,120 - piper_actor - DEBUG - Executed P2P(bwd_send, stage 1 -> 0, mb 3) on actor 1
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,120 - piper_actor - DEBUG - Actor 1 waiting for backward sync events
[36m(PiperActor pid=1051303)[0m 2026-02-18 23:04:30,120 - piper_actor - DEBUG - Actor 1 waiting for p2p ops
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,119 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 2) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,121 - piper_actor - DEBUG - Calling backward 0 mb 3 on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,121 - piper_actor - DEBUG - Dispatch bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,121 - piper_actor - DEBUG - Completed bwd p2p recv on 0 from 1
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,126 - piper_actor - DEBUG - Executed P2P(bwd_recv, stage 1 -> 0, mb 3) on actor 0
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,127 - piper_actor - DEBUG - Actor 0 waiting for backward sync events
[36m(PiperActor pid=1051350)[0m 2026-02-18 23:04:30,127 - piper_actor - DEBUG - Actor 0 waiting for p2p ops
[36m(run_dp_rank pid=1051295)[0m Ray timeline saved to: out/debug-pp2-dp1-interleaved-1f1b.json
[36m(PiperActor pid=1051303)[0m [rank1]:[W218 23:04:31.366773054 ProcessGroupNCCL.cpp:1553] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[36m(PiperActor pid=1051350)[0m [rank0]:[W218 23:04:32.601739028 ProcessGroupNCCL.cpp:1553] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
