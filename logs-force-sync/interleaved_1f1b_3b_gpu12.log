2026-02-02 03:02:56,559	INFO worker.py:2007 -- Started a local Ray instance.
/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
session_dir = /home/wxdeng/ray_tmp/ray/session_2026-02-02_03-02-51_131353_1531954
logs_dir    = /home/wxdeng/ray_tmp/ray/session_2026-02-02_03-02-51_131353_1531954/logs
[36m(PiperProgramCoordinator pid=1532723)[0m 2026-02-02 03:03:05,447 - piper_coordinator - INFO - Running program with 1 DP ranks and 2 PP ranks
[36m(run_dp_rank pid=1532722)[0m Namespace(model='LLAMA_3B', schedule='interleaved-1f1b', num_stages=4, dp_degree=1, pp_degree=2, batch_size=16, num_mbs=4, seq_len=256, warmup=1, iters=1, tracing=False, verify_weights=False)
[36m(run_dp_rank pid=1532722)[0m 2026-02-02 03:03:34,271 - piper_compile - INFO - DP rank 0 compiling 4 stages...
[33m(raylet)[0m WARNING: Device-side CUDA Event completion trace is currently enabled.
[33m(raylet)[0m          This may increase runtime overhead and the likelihood of false
[33m(raylet)[0m          dependencies across CUDA Streams. If you wish to avoid this, please
[33m(raylet)[0m          disable the feature with --cuda-event-trace=false.
[36m(PiperActor pid=1549638)[0m 2026-02-02 03:04:01,069 - piper_actor - INFO - Initializing Ray actor 0 global rank 0 with PID: 1549638
[33m(raylet)[0m WARNING: Device-side CUDA Event completion trace is currently enabled.
[33m(raylet)[0m          This may increase runtime overhead and the likelihood of false
[33m(raylet)[0m          dependencies across CUDA Streams. If you wish to avoid this, please
[33m(raylet)[0m          disable the feature with --cuda-event-trace=false.
[36m(PiperActor pid=1550778)[0m 2026-02-02 03:04:22,567 - piper_actor - INFO - Initializing Ray actor 1 global rank 1 with PID: 1550778
[36m(run_dp_rank pid=1532722)[0m 2026-02-02 03:04:48,319 - piper_compile - INFO - DP rank 0 joining process groups
[36m(run_dp_rank pid=1532722)[0m 2026-02-02 03:04:48,607 - piper_compile - INFO - DP rank 0 completed setup for 2 actors
[36m(run_dp_rank pid=1532722)[0m SCHEDULE:
[36m(run_dp_rank pid=1532722)[0m 0:0:f	0:1:f	2:0:f	2:1:f	0:2:f	0:3:f	2:0:b	 -- 	2:1:b	2:2:f	0:0:b	2:3:f	0:1:b	 -- 	2:2:b	2:3:b	0:2:b	0:3:b	0:0:u	
[36m(run_dp_rank pid=1532722)[0m  -- 	1:0:f	1:1:f	3:0:f	3:0:b	3:1:f	3:1:b	1:2:f	1:0:b	1:3:f	1:1:b	3:2:f	3:2:b	3:3:f	3:3:b	1:2:b	1:3:b	1:0:u	 -- 	
[36m(run_dp_rank pid=1532722)[0m Running 1 warmup iterations...
[36m(run_dp_rank pid=1532722)[0m 2026-02-02 03:04:49,187 - piper_compile - INFO - DP rank 0 Started NCCL group with 2 actors
[36m(PiperActor pid=1549638)[0m 2026-02-02 03:04:49,225 - piper_actor - INFO - Actor 0: Tracing disabled
[33m(raylet)[0m WARNING: Device-side CUDA Event completion trace is currently enabled.
[33m(raylet)[0m          This may increase runtime overhead and the likelihood of false
[33m(raylet)[0m          dependencies across CUDA Streams. If you wish to avoid this, please
[33m(raylet)[0m          disable the feature with --cuda-event-trace=false.
[36m(run_dp_rank pid=1532722)[0m Running 1 timed iterations...
[36m(run_dp_rank pid=1532722)[0m Iteration time: 6865 ms
[36m(run_dp_rank pid=1532722)[0m interleaved-1f1b throughput: 2387 tokens/sec
[36m(PiperActor pid=1550778)[0m 2026-02-02 03:04:49,225 - piper_actor - INFO - Actor 1: Tracing disabled
