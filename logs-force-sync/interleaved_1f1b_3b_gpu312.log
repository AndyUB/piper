2026-02-02 09:48:49,598	INFO worker.py:2007 -- Started a local Ray instance.
/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py:2046: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
session_dir = /home/wxdeng/ray_tmp/ray/session_2026-02-02_09-48-44_139804_2826956
logs_dir    = /home/wxdeng/ray_tmp/ray/session_2026-02-02_09-48-44_139804_2826956/logs
[36m(PiperProgramCoordinator pid=2827948)[0m 2026-02-02 09:48:58,568 - piper_coordinator - INFO - Running program with 1 DP ranks and 2 PP ranks
[36m(run_dp_rank pid=2827947)[0m Namespace(model='LLAMA_3B', schedule='interleaved-1f1b', num_stages=4, dp_degree=1, pp_degree=2, batch_size=16, num_mbs=4, seq_len=256, warmup=1, iters=1, tracing=False, verify_weights=False)
[36m(run_dp_rank pid=2827947)[0m 2026-02-02 09:49:28,327 - piper_compile - INFO - DP rank 0 compiling 4 stages...
[33m(raylet)[0m WARNING: Device-side CUDA Event completion trace is currently enabled.
[33m(raylet)[0m          This may increase runtime overhead and the likelihood of false
[33m(raylet)[0m          dependencies across CUDA Streams. If you wish to avoid this, please
[33m(raylet)[0m          disable the feature with --cuda-event-trace=false.
[36m(PiperActor pid=2845731)[0m 2026-02-02 09:49:53,609 - piper_actor - INFO - Initializing Ray actor 0 global rank 0 with PID: 2845731
[33m(raylet)[0m WARNING: Device-side CUDA Event completion trace is currently enabled.
[33m(raylet)[0m          This may increase runtime overhead and the likelihood of false
[33m(raylet)[0m          dependencies across CUDA Streams. If you wish to avoid this, please
[33m(raylet)[0m          disable the feature with --cuda-event-trace=false.
[36m(PiperActor pid=2847037)[0m 2026-02-02 09:50:13,768 - piper_actor - INFO - Initializing Ray actor 1 global rank 1 with PID: 2847037
[36m(run_dp_rank pid=2827947)[0m 2026-02-02 09:50:41,464 - piper_compile - INFO - DP rank 0 joining process groups
[36m(run_dp_rank pid=2827947)[0m 2026-02-02 09:50:41,472 - piper_compile - INFO - DP rank 0 completed setup for 2 actors
[36m(run_dp_rank pid=2827947)[0m SCHEDULE:
[36m(run_dp_rank pid=2827947)[0m 0:0:f	0:1:f	2:0:f	2:1:f	0:2:f	0:3:f	2:0:b	 -- 	2:1:b	2:2:f	0:0:b	2:3:f	0:1:b	 -- 	2:2:b	2:3:b	0:2:b	0:3:b	0:0:u	
[36m(run_dp_rank pid=2827947)[0m  -- 	1:0:f	1:1:f	3:0:f	3:0:b	3:1:f	3:1:b	1:2:f	1:0:b	1:3:f	1:1:b	3:2:f	3:2:b	3:3:f	3:3:b	1:2:b	1:3:b	1:0:u	 -- 	
[36m(run_dp_rank pid=2827947)[0m 2026-02-02 09:50:42,041 - piper_compile - INFO - DP rank 0 Started NCCL group with 2 actors
[36m(run_dp_rank pid=2827947)[0m Running 1 warmup iterations...
[36m(PiperActor pid=2845731)[0m 2026-02-02 09:50:42,073 - piper_actor - INFO - Actor 0: Tracing disabled
[33m(raylet)[0m WARNING: Device-side CUDA Event completion trace is currently enabled.
[33m(raylet)[0m          This may increase runtime overhead and the likelihood of false
[33m(raylet)[0m          dependencies across CUDA Streams. If you wish to avoid this, please
[33m(raylet)[0m          disable the feature with --cuda-event-trace=false.
[36m(run_dp_rank pid=2827947)[0m Running 1 timed iterations...
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s3_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s3_mb1()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb1()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb1()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb1()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb1()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(PiperActor pid=2847037)[0m 2026-02-02 09:50:42,073 - piper_actor - INFO - Actor 1: Tracing disabled
Traceback (most recent call last):
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/test/test_llama.py", line 304, in <module>
    ray.get(piper_coordinator.run_program.remote(main, args))
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
    return func(*args, **kwargs)
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py", line 2967, in get
    values, debugger_breakpoint = worker.get_objects(
  File "/m-coriander/coriander/wxdeng/conda-envs/piper_ref/lib/python3.10/site-packages/ray/_private/worker.py", line 1015, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(KeyError): [36mray::PiperProgramCoordinator.run_program()[39m (pid=2827948, ip=10.158.48.71, actor_id=36b806d3942413ef81e4d4ae01000000, repr=<src.piper_coordinator.PiperProgramCoordinator object at 0x7f4058dfae90>)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_coordinator.py", line 41, in run_program
    ret = ray.get([run_dp_rank.remote(
ray.exceptions.RayTaskError(KeyError): [36mray::run_dp_rank()[39m (pid=2827947, ip=10.158.48.71)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_coordinator.py", line 21, in run_dp_rank
    return training_func(*args, **kwargs)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/test/test_llama.py", line 236, in main
    iter_schedule()
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/test/test_llama.py", line 217, in iter_schedule
    ray.get(out)
ray.exceptions.RayTaskError(KeyError): [36mray::update_s1_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::bwd_s1_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::bwd_s2_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::bwd_s3_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::fwd_s3_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::fwd_s2_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::fwd_s1_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RayTaskError: [36mray::fwd_s0_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
  File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
    self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s2_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s3_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s2_mb1()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s3_mb1()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb1()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb1()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb1()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb1()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s0_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s1_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s2_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s3_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s3_mb2()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb2()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb2()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb2()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb2()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s0_mb1()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s1_mb1()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s2_mb1()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s3_mb1()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb1()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb1()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb1()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb1()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s3_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s2_mb2()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s3_mb2()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb2()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb2()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb2()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb2()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s2_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s3_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s0_mb2()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s1_mb2()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s2_mb2()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s3_mb2()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb2()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb2()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb2()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb2()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::bwd_s0_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s1_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s2_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s3_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb3()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb3()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
[36m(run_dp_rank pid=2827947)[0m Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): [36mray::update_s0_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s0_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s1_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s2_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::bwd_s3_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s3_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s2_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s1_mb0()[39m (pid=2847037, ip=10.158.48.71, actor_id=58fbe255797d2200e67205a801000000, repr=<src.piper_actor.PiperActor object at 0x7f82e52f67a0>)
[36m(run_dp_rank pid=2827947)[0m   At least one of the input arguments for this task could not be computed:
[36m(run_dp_rank pid=2827947)[0m ray.exceptions.RayTaskError: [36mray::fwd_s0_mb0()[39m (pid=2845731, ip=10.158.48.71, actor_id=78e4fff1e24234e21a4838ba01000000, repr=<src.piper_actor.PiperActor object at 0x7fe9eea5a7a0>)
[36m(run_dp_rank pid=2827947)[0m   File "/m-coriander/coriander/wxdeng/mlsys/piper_ref/src/piper_actor.py", line 324, in forward
[36m(run_dp_rank pid=2827947)[0m     self.trace_data[stage_id]["forward"]["forward_ref"].append(sync_time_ref)
[36m(run_dp_rank pid=2827947)[0m KeyError: 'forward_ref'
